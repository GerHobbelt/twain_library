<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_AddPDFText</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_addpdftext.htm"; }
  else { parent.quicksync('a5.8'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">DTWAIN_AddPDFText</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_acquiretoclipboard.htm">Previous</a>&nbsp;
     <a href="dtwain_arrayadd.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="color: #ff0000;">The following function is available only with DTWAIN / PDF</span>.</p>
<p>&nbsp;</p>
<p>The <span style="font-weight: bold;">DTWAIN_AddPDFText</span> adds text to a PDF page that is acquired using <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a> or <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a>.</p>
<p>&nbsp;</p>
<p style="text-indent: -95px; margin: 0px 0px 0px 96px;"><span style="font-weight: bold;">DTWAIN_BOOL DTWAIN_AddPDFText ( </span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN SOURCE</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LPCTSTR</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">szText</span><span style="font-weight: bold;">,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">xPos</span><span style="font-weight: bold;">,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">yPos</span>,</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LPCTSTR</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">szFontName</span>,</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">fontHeight,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">fontRGBColor,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">renderMode,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_FLOAT</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">scaling,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_FLOAT</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">charSpacing,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_FLOAT</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">wordSpacing,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">strokeWidth,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">displayFlags</span><span style="font-weight: bold;"> );</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -95px; margin: 0px 0px 0px 96px;"><span style="width:95px">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies a selected TWAIN <a href="twain_data_source.htm">Source</a>.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">szText</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the text to display on the generated PDF page.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">xPos, yPos</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the position, specified in points, of where the text is to be placed on the page.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">szFontName</span></p>
<p><span style="font-size: 2pt; font-family: 'Times New Roman'; color: #010100;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 12px;">The name of the font to be used for the text.  </p>
<p style="margin: 0px 0px 0px 12px;"><span style="font-size: 2pt; font-family: 'Times New Roman'; color: #010100;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">fontHeight</span></p>
<p><span style="font-style: italic;"> &nbsp; </span>The height to use for the font.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">fontRGBColor</span></p>
<p style="margin: 0px 0px 0px 15px;">The color to use for the text, specified as an RGB value.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">renderMode</span></p>
<p> &nbsp; &nbsp;One of the specified <span style="font-style: italic;">render modes</span> used to display the text. </p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">scaling</span></p>
<p> &nbsp; &nbsp;Horizontal scaling factor to use when displaying the text.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">charSpacing</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the spacing width between characters.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">wordSpacing</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the spacing width between words.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">strokeWidth</span></p>
<p style="margin: 0px 0px 0px 15px;">If <span style="font-style: italic;">renderMode </span>specifies a stroked rendering mode, this parameter specifies the stroke width of the characters.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">displayFlags</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies which pages to display the text, as well as which parameters from DTWAIN_AddPDFText to ignore when displaying the text.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values:</span></p>
<p>If the function succeeds, TRUE is returned, otherwise FALSE is returned.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Character specific version</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="107" style="width:107px;"><p>ANSI version:</p>
</td>
<td valign="top" width="156" style="width:156px;"><p><span style="font-weight: bold;">DTWAIN_AddPDFTextA</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="107" style="width:107px;"><p>Unicode version:</p>
</td>
<td valign="top" width="156" style="width:156px;"><p><span style="font-weight: bold;">DTWAIN_AddPDFTextW</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments:</span></p>
<p>The DTWAIN_AddPDFText function adds a line of text to a PDF page that was generated using <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a> or <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a>, and DTWAIN_PDF or DTWAIN_PDFMULTI is used as the file type to acquire. &nbsp;Usage of DTWAIN_AddPDFText can be used to add custom text, page numbers, etc. to each PDF page generated. &nbsp;You can call DTWAIN_AddPDFText multiple times to add multiple lines of text to a PDF page.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Once the PDF file is generated, the text that is added is removed from the <span style="font-style: italic;">Source</span>. &nbsp;In other words, your application will need to call DTWAIN_AddPDFText again for each call to DTWAIN_AcquireFile or DTWAIN_AcquireFileEx.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">szText</span> argument is the text to display on the page.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">xPos</span> and <span style="font-style: italic;">yPos</span> arguments determine where the text is placed on the PDF page (specified by (<span style="font-style: italic;">xPos, yPos</span>)). &nbsp; The <span style="font-style: italic;">xPos</span> and <span style="font-style: italic;">yPos</span> parameters are specified in <span style="font-style: italic;">points, </span>where a point is 1/72 of an inch (i.e. there are 72 points per inch). &nbsp;So for example, an 8.5" x 11" page has a width of 612 points and a height of 792 points.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The coordinate system used by PDF is based on the lower-left hand corner of the page being location (0, 0). &nbsp;The x-position increases as you go to the right edge of the page, and the y-position increases as you go up the page. &nbsp;For example, to place text on the left edge and close to the vertical center of an 8.5" x 11" inch page, the coordinates would be approximately (0, 396).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">szFontName</span> is the name of the font to use for the text. &nbsp;Currently the only fonts supported are the <span style="font-style: italic;">Adobe 14</span> fonts, specified below:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p><span style="font-weight: bold;">Font Name</span></p>
</td>
<td valign="top" width="686" style="width:686px;"><p><span style="font-weight: bold;">DTWAIN Constant (use with DTWAIN_GetPDFType1FontName)</span></p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Courier"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_COURIER</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Courier-Bold"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_COURIERBOLD</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px; height:14px;"><p>"Courier-BoldOblique"</p>
</td>
<td valign="top" width="686" style="width:686px; height:14px;"><p>DTWAIN_FONT_COURIERBOLDOBLIQUE</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Courier-Oblique"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_COURIEROBLIQUE</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Helvetica"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_HELVETICA</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Helvetica-Bold"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_HELVETICABOLD</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Helvetica-BoldOblique"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_HELVETICABOLDOBLIQUE</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Helvetica-Oblique"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_HELVETICAOBLIQUE</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Times-Bold"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_TIMESBOLD</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Times-BoldItalic"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_TIMESBOLDITALIC</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Times-Roman"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_TIMESROMAN</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Times-Italic"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_TIMESITALIC</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"Symbol"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_SYMBOL</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="156" style="width:156px;"><p>"ZapfDingbats"</p>
</td>
<td valign="top" width="686" style="width:686px;"><p>DTWAIN_FONT_ZAPFDINGBATS</p>
</td>
</tr>
</table>
</div>
<p>&nbsp;</p>
<p>In the table above, the column on the left denotes the string name of the font. &nbsp;This name is the name you would specify in the <span style="font-style: italic;">szFontName</span> parameter.  The column on the right is the DTWAIN constant that represents the name, and this constant can be used to get the string name by calling the DTWAIN_GetPDFType1FontName function.  </p>
<p>&nbsp;</p>
<p>The reason why it may be more desirable for DTWAIN_GetPDFType1FontName to return the name instead of specifying the literal string name is that using DTWAIN_GetPDFType1FontName returns the name without any misspelled or typographical errors.. &nbsp;Since the font name must match <span style="font-weight: bold;">exactly </span>with the Adobe 14 font name, calling DTWAIN_GetPDFType1FontName eliminates the chance that the name is incorrect.  </p>
<p>&nbsp;</p>
<p>For example, the two snippets of code below are equivalent DTWAIN_AddPDFText calls:</p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt; font-weight: bold;">1) DTWAIN_AddPDFText( Source, "Some Text", 0, 0, "Helvetica-Bold", ...)</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt; font-weight: bold;">2) char buf[100];</span></p>
<p><span style="font-size: 9pt; font-weight: bold;"> &nbsp; &nbsp;DTWAIN_GetPDFType1FontName(DTWAIN_FONT_HELVETICABOLD, buf, 100);</span></p>
<p><span style="font-size: 9pt; font-weight: bold;"> &nbsp; &nbsp;DTWAIN_AddPDFText( Source, "Some Text", 0, 0, buf, ...);</span></p>
<p>&nbsp;</p>
<p>The advantage of 1) is that it takes only a single call. &nbsp;The disadvantage, even though it isn't shown here, is that when writing code this way leaves a big possibility that the font name was misspelled by the programmer.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The advantage of 2) is that it guarantees that the font name is correct. &nbsp;The disadvantage is that it takes an additional function call (DTWAIN_GetPDFType1FontName) to return the font name.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">fontHeight</span> argument is the height of the font in points. &nbsp;Heights of 8, 10, and 12 are normally used, but height can be any integral value.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">fontRGBColor</span> argument denotes the color of the text. &nbsp;This value is specified by combining the Red (R), Green (G), and Blue (B) components thereby deriving a single color. &nbsp;The number that is generated from the combination of these colors is the same value used in HTML color values that you may see when you display the HTML of any web page (the color is usually denoted by a six-digit hexadecimal number, <span style="font-weight: bold;">#rrggbb,</span> where "rr" is red, "gg" is green, and "bb" is the blue component).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The red, green, and blue components range from 0 to 255 for each component. &nbsp;There are several ways to generate the RGB color, given the component values of R,G, and B.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>1) For Windows C/C++ programmers, the Windows API contains an RGB( ) macro that can be used to generate the color number.</p>
<p>2) For non-Windows programmers, use the DTWAIN_MakeRGB( ) function to generate the RGB value.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Black text has an RGB value where all the components are 0, while white text has an RGB value where all the components are 255. &nbsp;In between are the various shades of color (for example, gray has values of 127 for all the components). &nbsp;You can get an idea if you are using Windows, and you display a "Color Picker" dialog:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><img src="clip0025.gif" width="453" height="331" border="0" alt="clip0025"></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>In the lower right hand corner of the dialog are the Red, Green, and Blue components of the color described in "Color|Solid".  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>An example:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt; font-weight: bold;">DTWAIN_AddText(Source, "Some Text", 0, 0, "Helvetica", 12, DTWAIN_MakeRGB( 0, 78, 152 ), ... )</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>This creates text that has the same color denoted in the sample Color Picker dialog above..</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt; font-weight: bold;">DTWAIN_AddText(Source, "Some Text", 0, 0, "Helvetica", 12, DTWAIN_MakeRGB( 0, 78, 152 ), ... )</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>This creates text that has a gray color (this is if the DTWAIN_PDFTEXT_NORGBCOLOR is not specified in the <span style="font-style: italic;">displayFlags</span> argument).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">renderMode</span> argument denotes the rendering mode to use when displaying the text. &nbsp;The rendering mode determines if the text will be solid, shaded, invisible (useful to create a searchable PDF file), "hollow" (stroked), etc.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The various rendering modes and their effect are listed below:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="90" style="width:90px;"><p>Render Mode</p>
</td>
<td valign="top" width="148" style="width:148px;"><p>Definition</p>
</td>
<td valign="top" width="604" style="width:604px;"><p>Example:</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="middle" width="90" style="width:90px;"><p style="text-align: center;">0</p>
</td>
<td valign="top" width="148" style="width:148px;"><p>&nbsp;</p>
<p>Fill Text</p>
</td>
<td valign="top" width="604" style="width:604px;"><p><img src="clip0026.gif" width="37" height="43" border="0" alt="clip0026"></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="90" style="width:90px;"><p style="text-align: center;">&nbsp;</p>
<p style="text-align: center;">1</p>
</td>
<td valign="top" width="148" style="width:148px;"><p>&nbsp;</p>
<p>Stroke Text</p>
</td>
<td valign="top" width="604" style="width:604px;"><p><img src="clip0027.gif" width="41" height="45" border="0" alt="clip0027"></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="90" style="width:90px;"><p style="text-align: center;">&nbsp;</p>
<p style="text-align: center;">2</p>
</td>
<td valign="top" width="148" style="width:148px;"><p>&nbsp;</p>
<p>Fill and Stroke Text</p>
</td>
<td valign="top" width="604" style="width:604px;"><p><span class="f_ImageCaption"> &nbsp; <img src="clip0028.gif" width="34" height="40" border="0" alt="clip0028"></span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="90" style="width:90px;"><p style="text-align: center;">&nbsp;</p>
<p style="text-align: center;">3</p>
</td>
<td valign="top" width="148" style="width:148px;"><p>&nbsp;</p>
<p>Invisible Text</p>
</td>
<td valign="top" width="604" style="width:604px;"><br>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">scaling</span> argument denotes the amount of horizontal scaling to use when displaying the text. &nbsp;Setting this value adjusts the width of the text that's printed. &nbsp; For example, a <span style="font-style: italic;">scaling</span> value of 100.0 will leave the text unadjusted, while a <span style="font-style: italic;">scaling</span> of 50.0 reduces the text width by 50%, while a scaling factor of 200.0 will increase the width by twice the normal width.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">charSpacing</span> arguments denotes the space between characters of the words in the text. &nbsp;This value is denoted in points (there are 72 points per inch), and this value is added to the "natural" spacing between characters. &nbsp;Please note that this value can be between 0 and 1, meaning that the extra spacing can be finely tuned to a distance less than a point, and that <span style="font-style: italic;">charSpacing</span> can be a negative value, denoting a reduction in the space used between each character.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt; font-weight: bold;">DTWAIN_AddText(Source, "Some Text", 0, 0, "Helvetica", 12, DTWAIN_MakeRGB( 127, 127, 127 ), 0, </span><span style="font-size: 9pt; font-weight: bold; color: #ff6600;">0.25</span><span style="font-size: 9pt; font-weight: bold;">... )</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The 0.25 denotes that the extra spacing to add between characters is 1/4th of a point, which is equivalent to 1/288 of an inch (approximately 0.0035 inches). &nbsp; Please note that the <span style="font-style: italic;">scaling</span> parameter is ignored if <span style="font-style: italic;">displayFlags </span>has set the DTWAIN_PDFTEXT_NOSCALING bit set.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">wordSpacing</span> argument denotes the extra space between words (words are separated by the space (ASCII 32) character). &nbsp;This value is also specified in points. &nbsp;Similar to <span style="font-style: italic;">charSpacing</span> this value can be fractional and negative (to reduce the spacing between words).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">strokeWidth</span> argument is only used if <span style="font-style: italic;">renderMode</span> is 1 or 2. &nbsp;The <span style="font-style: italic;">strokeWidth</span> denotes the width, in points, of the outline of each of the characters. &nbsp;Usual values are 1, but a thicker line may be desired (a value of 2 or higher).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; text-decoration: underline;">Page Display Flags</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">displayFlags</span> argument denotes two things:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>The page or pages that the text will be displayed on</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>Which set of arguments specified in the argument list in DTWAIN_AddPDFText to ignore.</td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">displayFlags</span> is a combination of two values. &nbsp;The first value must be the page(s) to print the text. &nbsp;The following table describes the possible values:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p><span style="font-weight: bold;">Page Constant</span></p>
</td>
<td valign="top" width="579" style="width:579px;"><p><span style="font-weight: bold;">Definition</span></p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_ALLPAGES</p>
</td>
<td valign="top" width="579" style="width:579px;"><p>Text is printed on all the pages</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_EVENPAGES</p>
</td>
<td valign="top" width="579" style="width:579px;"><p>Text only appears on even pages (i.e page 2, 4, 6, etc.)</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_ODDPAGES</p>
</td>
<td valign="top" width="579" style="width:579px;"><p>Text only appears on odd pages (i.e. page 1, 3, 5, etc.)</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_FIRSTPAGE</p>
</td>
<td valign="top" width="579" style="width:579px;"><p>Text only appears on first page</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_LASTPAGE</p>
</td>
<td valign="top" width="579" style="width:579px;"><p>Text only appears on last page</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_CURRENTPAGE</p>
</td>
<td valign="top" width="579" style="width:579px;"><p>Text only appears on the currently acquired page.</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">displayFlags</span> must use only one of the page options above. &nbsp; &nbsp;Please note:  The DTWAIN_PDFTEXT_CURRENTPAGE is only useful if you're processing DTWAIN notifications during a multi-page acquisition, and want to change the text on each page. &nbsp; See the "SavePDF_PageNumber" example program found in the DTWAIN installation to see how to use the DTWAIN_PDFTEXT_CURRENTPAGE effectively.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #ff0000;">Tip: &nbsp;If you desire to customize exactly which page your text will be placed on, the best way is to use the DTWAIN_PDFTEXT_CURRENTPAGE, and capture the DTWAIN_TN_FILEPAGESAVING notification. This notification is always sent once (and only once) before a PDF page is generated. &nbsp; Your application should keep some sort of a counter variable within the notification that gets incremented each time DTWAIN_TN_FILEPAGESAVING is sent. &nbsp;If the counter equals the page number that you want to add text to, call DTWAIN_AddPDFText using the DTWAIN_PDFTEXT_CURRENTPAGE flag.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The second thing that <span style="font-style: italic;">displayFlags </span>denotes is which set of parameters from the parameter list are to be ignored. &nbsp;The table below lists the possible values:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p><span style="font-weight: bold;">Parameter Constant</span></p>
</td>
<td valign="top" width="266" style="width:266px;"><p><span style="font-weight: bold;">Definition</span></p>
</td>
<td valign="top" width="186" style="width:186px;"><p><span style="font-weight: bold;">Default value when set</span></p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_NOSCALING</p>
</td>
<td valign="top" width="266" style="width:266px;"><p>Ignore the <span style="font-style: italic;">scaling</span> parameter.</p>
</td>
<td valign="top" width="186" style="width:186px;"><p>100.0</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_NOCHARSPACING</p>
</td>
<td valign="top" width="266" style="width:266px;"><p>Ignore the <span style="font-style: italic;">charSpacing</span> parameter.</p>
</td>
<td valign="top" width="186" style="width:186px;"><p>0.0</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_NOWORDSPACING</p>
</td>
<td valign="top" width="266" style="width:266px;"><p>Ignore the <span style="font-style: italic;">wordSpacing</span> parameter.</p>
</td>
<td valign="top" width="186" style="width:186px;"><p>0.0</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_NORENDERMODE</p>
</td>
<td valign="top" width="266" style="width:266px;"><p>Ignore the <span style="font-style: italic;">renderMode</span> parameter.</p>
</td>
<td valign="top" width="186" style="width:186px;"><p>0</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_NORGBCOLOR</p>
</td>
<td valign="top" width="266" style="width:266px;"><p>Ignore the <span style="font-style: italic;">rgbColor</span> parameter.</p>
</td>
<td valign="top" width="186" style="width:186px;"><p>0 (black text)</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_NOFONTSIZE</p>
</td>
<td valign="top" width="266" style="width:266px;"><p>Ignore the <span style="font-style: italic;">fontSize</span> parameter.</p>
</td>
<td valign="top" width="186" style="width:186px;"><p>10</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="263" style="width:263px;"><p>DTWAIN_PDFTEXT_IGNOREALL</p>
</td>
<td valign="top" width="266" style="width:266px;"><p>Ignore <span style="font-style: italic;">scaling, charSpacing, wordSpacing, renderMode, rgbColor, </span>and<span style="font-style: italic;"> fontSize </span>parameters.</p>
</td>
<td valign="top" width="186" style="width:186px;"><p>See above for defaults for these parameters.</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Therefore, <span style="font-style: italic;">displayFlags</span> is a combination of exactly one page constant, and zero or more parameter constants.  For example, if you want text to appear &nbsp;on the lower-left hand corner of only first page, colored gray, using the Helvetica font, and scaled to 50%, the following would be done:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt; font-weight: bold;">LONG options = DTWAIN_PDFTEXT_FIRSTPAGE | DTWAIN_PDFTEXT_NOCHARSPACING |</span></p>
<p><span style="font-size: 9pt; font-weight: bold;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PDFTEXT_NOWORDSPACING | DTWAIN_PDFTEXT_NORENDERMODE |</span></p>
<p><span style="font-size: 9pt; font-weight: bold;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PDFTEXT_NOFONTSIZE;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt; font-weight: bold;">DTWAIN_AddPDFText( Source, "Some Text", 0, 0, "Helvetica", 0, DTWAIN_MakeRGB(127,127,127), 0, 50.0, 0, 0, 0, options );</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The code above that generates the <span style="font-weight: bold;">options</span> value just combines the values using the bitwise OR (C/C++ programmers only). &nbsp;If your language doesn't have a bitwise OR operator, you can simply add the values together.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>When the "Some Text" is displayed, it will be located in the lower left hand corner of the page (position (0,0)), use the "Helvetica" font, and be colored grayed, and scaled to 50%. &nbsp;The font size, word spacing, character spacing, and render mode arguments are ignored, therefore the default &nbsp;values are used for these settings. &nbsp;This means that the font size will be 10 points, the word and character spacing will be 0, and the render mode will be 0.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p><a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_995107139X, true);" class="popuplink">State 4</a>(if Source is not opened)</p>
<p>State <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_1530542323X, true);" class="popuplink">5</a>, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_831869247, true);" class="popuplink">6</a>, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_1591487050X, true);" class="popuplink">7</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a></p>
<p><a href="selectingthetwainsource.htm">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_acquirebuffered.htm">DTWAIN_AcquireBuffered</a>, <a href="dtwain_acquirenative.htm">DTWAIN_AcquireNative</a>, <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a></p>

</td></tr></table>

</body>
</html>
