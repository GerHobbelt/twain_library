<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>Locating and Loading the TWAIN DSM File</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?twain_data_source_manager.htm"; }
  else { parent.quicksync('a3.1.2.3'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Locating and Loading the TWAIN DSM File</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="startingatwainsession.htm">Previous</a>&nbsp;
     <a href="dtwainerrorhandling.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>When the <a href="dtwain_starttwainsession.htm">DTWAIN_StartTwainSession</a> function is called with a NULL second argument, DTWAIN searches the local file system for the appropriate TWAIN DSM file (either TWAIN_32.DLL or TWAINDSM.DLL).</p>
<p>&nbsp;</p>
<p>By default, DTWAIN will search the following directories in the order below to find the DSM file:</p>
<p>&nbsp;</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="15"><span style="font-size: 10pt; font-family: 'Arial'; color: #000000;">1)</span></td><td>The directory that is designated as the <span style="font-weight: bold;">WINDOWS</span> directory by the system. &nbsp;The WINDOWS directory is the directory returned by calling the Windows API function <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724454%28v=vs.85%29.aspx" target="_blank" class="weblink">GetWindowsDirectory</a>.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="15"><span style="font-size: 10pt; font-family: 'Arial'; color: #000000;">2)</span></td><td>The directory that is designated as the <span style="font-weight: bold;">SYSTEM</span> directory by the system. &nbsp;The SYSTEM directory is the directory returned by calling the Windows API function <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724373%28v=vs.85%29.aspx" target="_blank" class="weblink">GetSystemDirectory</a>.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="15"><span style="font-size: 10pt; font-family: 'Arial'; color: #000000;">3)</span></td><td>The <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms682586%28v=vs.85%29.aspx" target="_blank" class="weblink">Windows operating system search logic</a> when attempting to find Dynamic Link Library (DLL) files.  </td></tr></table></div><p>&nbsp;</p>
<p>If the TWAIN_32.DLL or TWAINDSM.DLL file is not found in either 1), 2), or 3) above, then DTWAIN will return an error whenever a function is called that requires the TWAIN DSM to be loaded in memory. &nbsp;This includes opening a TWAIN Data Source and various other functions.  </p>
<p>&nbsp;</p>
<p>The first directory where TWAIN_32.DLL or TWAINDSM.DLL is found in will be the version that will be loaded by DTWAIN_StartTwainSession. &nbsp;For example, if TWAIN_32.DLL is found in the WINDOWS directory first, then that is the version that will be used (thus not necessary to search in the SYSTEM or have the OS search for the DSM file).</p>
<p>&nbsp;</p>
<p>If the DSM file can be found, but the DSM file is not a valid TWAIN DSM file, an error is also returned. &nbsp;This ensures that any other files that are named TWAIN_32.DLL or TWAINDSM.DLL that are not true DSM files will not be used.</p>
<p>&nbsp;</p>
<p>To get the full path name of the DSM that DTWAIN will eventually use (or is currently using), you can call the <a href="dtwain_getdsmfullname.htm">DTWAIN_GetDSMFullName</a> function.</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold; text-decoration: underline;">Additional Search Order Options</span></p>
<p>&nbsp;<br>
In addition to the search order described above, DTWAIN can allow the application to set the search order for finding the TWAIN DSM, as well as limit the number of directories to search. &nbsp;For example, your application may want to only search the <span style="font-weight: bold;">WINDOWS</span> directory for the DSM file, and if not found, return an error. &nbsp;See the <a href="dtwain_setdsmsearchorder.htm">DTWAIN_SetDSMSearchOrder</a> function for setting this option.</p>

</td></tr></table>

</body>
</html>
