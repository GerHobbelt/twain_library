<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_GetCapValuesEx</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DTWAIN_GetCapValuesEx" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_getcapvaluesex.htm"; }
  else { parent.quicksync('a5.137'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">DTWAIN_GetCapValuesEx</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_getcapvalues.htm">Previous</a>&nbsp;
     <a href="dtwain_getcapvaluesex2.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <span style="font-weight: bold;">DTWAIN_GetCapValuesEx</span> function gets the capability value(s) for a Source while specifying the TWAIN container type to use.</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_BOOL DTWAIN_GetCapValues (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">DTWAIN_SOURCE</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Capability,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">GetType,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Container,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LPDTWAIN_ARRAY</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">pCapValues </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">An open <a href="twain_data_source.htm">TWAIN Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">Capability</span></p>
<p style="margin: 0px 0px 0px 15px;">The capability that is to be retrieved.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">GetType</span></p>
<p style="margin: 0px 0px 0px 15px;">Indicates which type of retrieval to do.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">Container</span></p>
<p style="margin: 0px 0px 0px 15px;">Indicates the TWAIN container to use</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">PCapValues</span></p>
<p style="margin: 0px 0px 0px 15px;">Address of a <a href="overview_of_dtwain_arrays.htm">DTWAIN_ARRAY</a> containing the values retrieved.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>The return value is <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, true);" class="popuplink">TRUE</a> if successful. &nbsp;Otherwise <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, true);" class="popuplink">FALSE</a><span style="font-weight: bold;"> </span>is returned.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>The <span style="font-weight: bold;">DTWAIN_GetCapValuesEx</span> function sets a Source's device capability  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #ff0000;">Caution:</span></p>
<p><span style="font-weight: bold; color: #ff0000;">The TWAIN specification explicitly does not allow an application to determine the container for getting capability values. &nbsp;Therefore, DTWAIN_GetCapValuesEx is an advanced function and should be used </span><span style="font-weight: bold; color: #ff0000; text-decoration: underline;">only</span><span style="font-weight: bold; color: #ff0000;"> to test a Source and how it handles getting capability values given different container types. &nbsp;Some Sources will not behave correctly and corrupt the operating system if given the wrong container type to use. &nbsp;If all that is desired is to get the capability values in the safest manner, use the </span><span style="font-size: 12pt; font-family: 'Times New Roman'; font-weight: bold; color: #ff0000;"><a href="dtwain_getcapvalues.htm">DTWAIN_GetCapValues</a></span><span style="font-weight: bold; color: #ff0000;"> function.  </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The difference between <a href="dtwain_getcapvalues.htm">DTWAIN_GetCapValues</a> and DTWAIN_GetCapValuesEx is that DTWAIN_GetCapValuesEx relies on the programmer to specify the TWAIN container to use.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Depending on the TWAIN container, values must be placed in the container in a certain way when retrieving capability values. &nbsp;The TWAIN container is not used explicitly by the application. &nbsp;The only two entities that use the containers are DTWAIN and TWAIN. &nbsp; The only structure that the application will use to read the retrieved values is the DTWAIN_ARRAY <span style="font-style: italic;">pCapValues</span>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Basically, DTWAIN extracts the values from the Source<span style="font-style: italic;"> </span>by telling TWAIN to use the container specified by <span style="font-style: italic;">Container</span>, and if successful, places the value retrieved from the Source into the DTWAIN_ARRAY specified by <span style="font-style: italic;">pCapValues</span>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To specify the container to use, Container should be one of the following values (the constants below define each container and their TWAIN equivalents):</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="1" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="266" style="width:266px;"><p><span style="text-decoration: underline;">DTWAIN_Container</span></p>
</td>
<td valign="top" width="52" style="width:52px;"><p><span style="text-decoration: underline;">Value</span></p>
</td>
<td valign="top" width="202" style="width:202px;"><p><span style="text-decoration: underline;">TWAIN Equivalent</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="266" style="width:266px;"><p>DTWAIN_CONTONEVALUE</p>
</td>
<td valign="top" width="52" style="width:52px;"><p>1 &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="202" style="width:202px;"><p>TW_ONEVALUE</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="266" style="width:266px;"><p>DTWAIN_CONTARRAY </p>
</td>
<td valign="top" width="52" style="width:52px;"><p>2 &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="202" style="width:202px;"><p>TW_ARRAY</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="266" style="width:266px;"><p>DTWAIN_CONTRANGE</p>
</td>
<td valign="top" width="52" style="width:52px;"><p>4 &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="202" style="width:202px;"><p>TW_RANGE</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="266" style="width:266px;"><p>DTWAIN_CONTENUMERATION</p>
</td>
<td valign="top" width="52" style="width:52px;"><p>8 &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="202" style="width:202px;"><p>TW_ENUMERATION</p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -191px; margin: 0px 0px 0px 192px;"><span style="color: #000000;">&nbsp;</span></p>
<p>Note: DTWAIN_CONTONEVALUE, DTWAIN_CONTARRAY, and DTWAIN_CONTENUMERATION, uses a DTWAIN_ARRAY of the actual values that are to be set. The only odd one is the DTWAIN_CONTRANGE, where the elements in the DTWAIN_ARRAY are to be read using the special DTWAIN Range functions.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>It is imperative that you understand the difference in the container types. &nbsp;DTWAIN simplifies the matter of setting up the containers internally; all you have to do is specify to DTWAIN which one to use, and DTWAIN does the job For an explanation of the container types, you can get the TWAIN specification from here.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>For more information on parameter definitions see <a href="dtwain_setcapvalues.htm">DTWAIN_GetCapValues</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>The Source must be in <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_995107139X, true);" class="popuplink">State 4</a> or higher (depending on the capability).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><a href="selectingthetwainsource.htm">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm">Setting / Getting Twain Capabilities</a></p>

</td></tr></table>

</body>
</html>
