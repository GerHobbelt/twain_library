<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_AcquireFile</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_acquirefile.htm"; }
  else { parent.quicksync('a5.3'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">DTWAIN_AcquireFile</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_acquirebufferedex.htm">Previous</a>&nbsp;
     <a href="dtwain_acquirefileex.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <span style="font-weight: bold;">DTWAIN_AcquireFile</span> starts the image acquisition from a Source and saves the image(s) to file or multiple files</p>
<p>&nbsp;</p>
<p style="text-indent: -95px; margin: 0px 0px 0px 96px;"><span style="font-weight: bold;">DTWAIN_BOOL &nbsp;DTWAIN_AcquireFile (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN SOURCE</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LPCTSTR</span> </p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">FileNames</span>,</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">FileType</span>,</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">FileControlFlag</span>,</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">PixelType</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">NumPages</span><span style="font-weight: bold;">,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bShowUI</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bCloseSource</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="123" style="width:123px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="137" style="width:137px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">pStatus</span> <span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p>Specifies a selected TWAIN <a href="twain_data_source.htm">Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">FileNames</span></p>
<p>Points to a null terminated string denoting the file name(s) or NULL.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">FileType</span></p>
<p>Specifies the file format to save the acquired images.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">FileControlFlag</span></p>
<p>Specifies user interaction and which transfer mode to use.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">PixelType</span></p>
<p>Specifies the pixel type of the image</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">NumPages</span></p>
<p>Specifies the number of pages to acquire.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">bShowUI</span></p>
<p>Specifies whether the Source displays the default User Interface.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">bCloseSource</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies whether the Source should be automatically closed when the User Interface is closed.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">pStatus</span></p>
<p>NULL, or is the address of a variable that will be filled in with an error status value.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>If the function succeeds, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, true);" class="popuplink">TRUE</a> is returned. &nbsp;If the function fails <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, true);" class="popuplink">FALSE</a> is returned and <span style="font-style: italic;">pStatus</span> is set to the error that occurred.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Character specific version</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="107" style="width:107px;"><p>ANSI version:</p>
</td>
<td valign="top" width="156" style="width:156px;"><p><span style="font-weight: bold;">DTWAIN_AcquireFileA</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="107" style="width:107px;"><p>Unicode version:</p>
</td>
<td valign="top" width="156" style="width:156px;"><p><span style="font-weight: bold;">DTWAIN_AcquireFileW</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>Starts the image acquisition from a TWAIN device and saves the acquired image(s) to a file or multiple files. &nbsp;The arguments <span style="font-style: italic;">PixelType, Source, NumPages, bShowUI</span>, <span style="font-style: italic;">bCloseSource</span>,<span style="font-style: italic;"> </span>and <span style="font-style: italic;">pStatus</span> all have the same definitions as <a href="dtwain_acquirenative.htm">DTWAIN_AcquireNative</a><span style="font-weight: bold;">.  </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If you are attempting to store images with file names that have embedded spaces (for example "C:\Program &nbsp; &nbsp; Files.BMP"), use <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a> instead of DTWAIN_AcquireFile. &nbsp;If you specify a full path name for the file to save, the directory specified must already exist. &nbsp;If not, a DTWAIN_TN_FILEPAGESAVEERROR will be generated and sent as a <a href="processing_acquisition_message.htm">notification</a> to your application.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>DTWAIN supports the "Acquire To File" mode that some Sources have implemented, as well as a DTWAIN mode that can be used for any Source, even if the Source does not have internal file transfer support. &nbsp;See the end of this topic for more information on using the DTWAIN internal file support and how to set the <span style="font-style: italic;">FileType</span> argument.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<hr noshade size=1 style="color : #000000"><p>Here are some examples using DTWAIN_AcquireFile:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Acquire all pages to individual BMP files using DTWAIN mode, prompting for a file name: &nbsp;Native transfer is used:</p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_AcquireFile( Source, NULL, DTWAIN_BMP, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_USENATIVE + DTWAIN_USEPROMPT, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PT_DEFAULT, DTWAIN_ACQUIREALL, TRUE, TRUE, NULL);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Acquire all pages to a multi-page Group 3 TIFF file using DTWAIN mode, the file name is provided.</p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_AcquireFile( Source, "image.tif", DTWAIN_TIFFG3MULTI, </span></p>
<p><span style="width:48px">&nbsp;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_USENATIVE + DTWAIN_USENAME, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PT_BW, DTWAIN_ACQUIREALL, TRUE, TRUE, NULL);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Acquire 1 page to an XBM file. &nbsp;The XBM file is transferred using the Source's internal file transfer support (assume the Source supports XBM transfers). &nbsp;The name is provided:</p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_AcquireFile( Source, "image.tif", DTWAIN_FF_XBM, </span></p>
<p><span style="width:48px">&nbsp;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_USESOURCEMODE + DTWAIN_USENAME, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PT_DEFAULT, 1, TRUE, TRUE, NULL);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Acquire 3 pages to a BMP file using DTWAIN mode. &nbsp;The file names are provided for each file (image1.bmp, image2.bmp, image3.bmp)</p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_AcquireFile( Source, "image1.bmp image2.bmp image3.bmp", DTWAIN_BMP, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_USENATIVE + DTWAIN_USENAME, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PT_DEFAULT, 3, TRUE, TRUE, NULL);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Acquire 3 pages to a BMP file using DTWAIN mode. &nbsp;The file names are auto-generated by DTWAIN, given only the first name.</p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_AcquireFile( Source, "image.bmp", DTWAIN_BMP, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_USENATIVE + DTWAIN_USENAME, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PT_DEFAULT, 3, TRUE, TRUE, NULL);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The last example will create image.bmp, image2.bmp, image3.bmp.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The next section describes the parameters and other aspects of using DTWAIN_AcquireFile correctly:</p>
<hr noshade size=1 style="color : #000000"><p><span style="font-weight: bold; text-decoration: underline;">Parameters</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; text-decoration: underline;">The File Control flag</span></p>
<p>The <span style="font-style: italic;">FileControlFlag</span> determines how the image retrieval and file saving mechanism will work. The values for the <span style="font-style: italic;">FileControlFlag</span> are bitwise ORed. &nbsp;If your language does not have a bitwise OR, the values can be added together to get the same results.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">FileControlFlag</span> controls the following:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>Whether to use the DTWAIN file transfer support, or use the Source's internal file transfer support</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>Whether the <a href="nativetransfer.htm">native</a> or <a href="bufferedtransfer.htm">buffered</a> mode will be used to acquire the image(s) if using DTWAIN file transfer support.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>The method in which the acquired image files will be named.</td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p>To control which image transfer mode the Source will use, the <span style="font-style: italic;">FileControlFlag</span> must consist of <span style="text-decoration: underline;">only one</span> of the following:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="1" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="224" style="width:224px;"><p><span style="text-decoration: underline;">Transfer Mode</span></p>
</td>
<td valign="top" width="64" style="width:64px;"><p><span style="text-decoration: underline;">Value &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
</td>
<td valign="top" width="260" style="width:260px;"><p><span style="text-decoration: underline;">Defintion</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="224" style="width:224px;"><p>DTWAIN_USENATIVE</p>
</td>
<td valign="top" width="64" style="width:64px;"><p>1</p>
</td>
<td valign="top" width="260" style="width:260px;"><p>Use the Native Transfer Mode.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="224" style="width:224px;"><p>DTWAIN_USEBUFFERED</p>
</td>
<td valign="top" width="64" style="width:64px;"><p>2</p>
</td>
<td valign="top" width="260" style="width:260px;"><p>Use the Buffered Transfer Mode &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(uncompressed mode only).</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="224" style="width:224px;"><p>DTWAIN_USESOURCEMODE </p>
</td>
<td valign="top" width="64" style="width:64px;"><p>32</p>
</td>
<td valign="top" width="260" style="width:260px;"><p>Use the Source's internal file support.</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The DTWAIN_USESOURCEMODE flag uses the Source's internal "Acquire To File" support. &nbsp;There are many Sources that do not have internal support for file acquisitions. Before using this method, see <span style="font-weight: bold;">Internal Source File Transfer Issues</span> below.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If neither DTWAIN_USENATIVE, DTWAIN_USEBUFFERED nor DTWAIN_USESOURCEMODE is specified in the <span style="font-style: italic;">FileControlFlag</span>, the transfer method is assumed to be DTWAIN_USENATIVE. &nbsp;If both DTWAIN_USENATIVE and DTWAIN_USEBUFFERED are specified, DTWAIN_USENATIVE is used.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To control the way the file names are generated, the <span style="font-style: italic;">FileControlFlag</span> must consist of <span style="text-decoration: underline;">only one</span> of the following:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="1" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="226" style="width:226px;"><p><span style="text-decoration: underline;">How to create name</span></p>
</td>
<td valign="top" width="62" style="width:62px;"><p><span style="text-decoration: underline;">Value</span></p>
</td>
<td valign="top" width="401" style="width:401px;"><p><span style="text-decoration: underline;">Definition</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="226" style="width:226px;"><p>DTWAIN_USENAME</p>
</td>
<td valign="top" width="62" style="width:62px;"><p>4 &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="401" style="width:401px;"><p>Use name(s) in <span style="font-style: italic;">FileNames</span> argument.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="226" style="width:226px;"><p>DTWAIN_USEPROMPT</p>
</td>
<td valign="top" width="62" style="width:62px;"><p>8</p>
</td>
<td valign="top" width="401" style="width:401px;"><p>Prompt for the filename(s). &nbsp;Before using this option, please read <span style="font-weight: bold; text-decoration: underline;">Compatibility Issues with DTWAIN_USEPROMPT</span> below.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="226" style="width:226px;"><p>DTWAIN_USELONGNAME &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="62" style="width:62px;"><p>16</p>
</td>
<td valign="top" width="401" style="width:401px;"><p>Same as DTWAIN_USENAME, but generate long file names</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If DTWAIN_USENAME or DTWAIN_USELONGNAME is specified, the list of names provided by the <span style="font-style: italic;">FileNames</span> argument specifies the names of the files that each acquired page will be saved to. &nbsp; This argument is a null terminated string denoting a list of filenames separated by either white space (tabs or spaces) commas (,), semicolons (;) or pipes (|). &nbsp; Here are examples:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="1" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="247" style="width:247px;"><p>"File1.bmp" &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="274" style="width:274px;"><p>(A single file named File1.bmp)</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="247" style="width:247px;"><p>"File1.bmp File2.bmp File3.bmp" &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="274" style="width:274px;"><p>(3 files; File1.bmp, File2.bmp, File3.bmp)</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="247" style="width:247px;"><p>"File1.bmp | File2.bmp | File3.bmp" &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="274" style="width:274px;"><p>(Same as above)</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="247" style="width:247px;"><p>"File1.bmp, File2.bmp, File3.bmp" &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="274" style="width:274px;"><p>(Same as above)</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="247" style="width:247px;"><p>"File1.bmp; File2.bmp" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="274" style="width:274px;"><p>(2 files; File1.bmp, File2.bmp)</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The DTWAIN_USELONGNAME works exactly the same as DTWAIN_USENAME except that the names specified by <span style="font-style: italic;">FileNames</span> can consist of long file names (names that are longer than the old 8 character name, 3 character extension DOS names).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Note: If your file names contain spaces, you should not use DTWAIN_AcquireFile, and instead use <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a>. &nbsp;DTWAIN_AcquireFileEx is equivalent to DTWAIN_AcquireFile, with the exception being that the file names can have embedded spaces (for example "C:\Files &nbsp;To &nbsp;Acquire" will not work with DTWAIN_AcquireFile, but will work with DTWAIN_AcquireFileEx). &nbsp;DTWAIN_AcquireFile recognizes the space as a delimiter between file names, therefore DTWAIN_AcquireFile will not work correctly with file names that have embedded spaces.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If DTWAIN_USEPROMPT is specified, the usual Windows "Save As" dialog is displayed for each acquired page (see <a href="dtwain_setfilesavepos.htm">DTWAIN_SetFileSavePos</a> and DTWAIN_SetCustomFileSave for customization of the "Save As" dialog). &nbsp;The dialog is displayed only when the image data has been acquired from the Source without error. If DTWAIN_USEPROMPT is combined with any of the other file saving methods, DTWAIN_USEPROMPT is always assumed. &nbsp;For languages that do not have a Boolean OR available (the '|' operator in C or C++), the language can merely add the values to get the final <span style="font-style: italic;">FileControlFlag</span> value. &nbsp;For example, </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>DTWAIN_USEPROMPT + DTWAIN_USENATIVE is equivalent to </p>
<p>DTWAIN_USEPROMPT | DTWAIN_USENATIVE</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; text-decoration: underline;">The </span><span style="font-style: italic; font-weight: bold; text-decoration: underline;">FileType</span><span style="font-weight: bold; text-decoration: underline;"> value</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the application desires to use the DTWAIN mode for file transfers, the <span style="font-style: italic;">FileType</span> argument determines what file format the image will be saved in. &nbsp;This value can be equal to one of the <a href="dtwain_file_transfer_constants.htm">DTWAIN File Transfer Constants</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Note that if you are calling DTWAIN_AcquireFile or DTWAIN_AcquireFileEx and are not using the Source's internal file transfer support (DTWAIN_USESOURCEMODE is not set in <span style="font-style: italic;">FileControlFlag</span>), DTWAIN internally uses Native or Buffered transfer types to retrieve the Device Independent Bitmap(s) (DIB), and subsequentally saves the DIBs to the file type specified below. &nbsp;This means that the DIB must have the proper bit-depth, or bits-per-pixel before it can be saved to the proper format.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Note:</p>
<p>If acquiring images with no user interface, it is <span style="text-decoration: underline;">highly</span> recommended that your application calls DTWAIN_SetPixelType( ) and/or DTWAIN_SetBitDepth( ) to ensure that the Source will be creating images with the proper pixel type and bit depth.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Below is a table describing the valid bit-depths for each file type:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="1" border="1" style="border: solid 2px #000000; border-spacing:0px; border-collapse: collapse;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p><span style="text-decoration: underline;">File Type</span></p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p><span style="text-decoration: underline;">Bit Depth (Bits-Per-Pixel)</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><br>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><br>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>BMP &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>Any bit depth</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>JPEG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>8, 16, or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>JPEG-2000</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>8, 16, or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*PCX &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 8 or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>TGA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>8 or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*TIFF No compression &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 4, 8, 16, or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*TIFF Group 3 Fax</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*TIFF Group 4 Fax</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*TIFF PackBits</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 4, 8, 16, or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*TIFF Deflate &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 4, 8, 16, or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*TIFF LZW Compression</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 4, 8, 16, or 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*TIFF JPEG Compression</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>8, 16, 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>Windows Metafile (WMF)</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>Enhanced Metafile (EMF)</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>GIF </p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 8</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>PNG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 8, 16, 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>Adobe PSD &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*Adobe PDF</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 8, 16, 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>*Adobe PostScript </p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 8, 16, 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>**Windows Icon (ICO )</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1, 8, 16, 24</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>***Wireless Bitmap (WBMP)</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>1</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="240" style="width:240px; border: solid 1px #000000;"><p>****Text</p>
</td>
<td valign="top" width="195" style="width:195px; border: solid 1px #000000;"><p>Not Applicable</p>
</td>
</tr>
</table>
</div>
<p><span style="width:48px">&nbsp;</span></p>
<p>* Value apply to single page and multi-page varieties of these file types.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>** Non-Vista Windows ICON files cannot have a bitmap width or height greater than 255 pixels.  <br>
&nbsp;<br>
*** Wireless Bitmaps must be 1 bit-per-pixel, and cannot have width or height greater than 255 pixels.  <br>
&nbsp;</p>
<p>**** The Text format is only available if one of the supported <a href="ocr_processing.htm">OCR</a> engines is installed. &nbsp;In addition, the Text format is available as a multi-page type <span style="font-style: italic;">only if the OCR engine supports multi-page text files.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The Adobe PDF and PostScript formats are available only with the DTWAIN / PDF support code, which is available separately from the base DTWAIN DLL.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #ff0000;">Special Note: &nbsp;The saving of Adobe PDF and PostScript files requires a writeable and accessible temporary directory. &nbsp;If you are attempting to acquire PDF / PostScript files, and have errors in creating the file, make sure that your temporary directory (usually C:\TEMP, please check your System settings) is writeable and accessible from the computer running the application.  </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #ff0000;">Also, PDF / PostScript creation requires that your acquired images are 1, 8, 16, or 24 bit images. &nbsp;If they are any other bit-depth, the PDF / PostScript creation will fail, or the PDF file will not be created correctly.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Currently, DTWAIN does not convert the DIBs to the proper bits-per-pixel if the DIB has the incorrect bit depth for a certain file type. &nbsp;For example, if the Source acquires to a 24-bit DIB, there is currently no way for DTWAIN to save the DIB to a TIFF Group 3 Fax format. &nbsp;For situations where the bit depth has to be reduced (or increased), it is recommended to use third-party imaging code that can increase or reduce bit depth to the desired level and instead call DTWAIN_AcquireNative or DTWAIN_AcquireBuffered to handle the DIBs. &nbsp;In a future version of DTWAIN, this problem will most likely be remedied by doing bit-depth reduction or increasing the bit-depth of the acquired image to match the valid bit-per-pixel value.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If there is a problem creating the file, call <a href="dtwain_getlasterror.htm">DTWAIN_GetLastError</a> to get the error code.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<hr noshade size=1 style="color : #000000"><p><span style="font-weight: bold; text-decoration: underline;">Internal Source File Transfer Issues</span></p>
<p>Before an application attempts to use this method (when the <span style="font-style: italic;">FileControlFlag</span> has DTWAIN_USESOURCEMODE set), the application should call <a href="dtwain_isfilexfersupported.htm">DTWAIN_IsFileXferSupported</a> to determine whether the Source can support file transfers. &nbsp;The application should also call <a href="dtwain_getfilexferformats.htm">DTWAIN_EnumFileXferFormats</a> to determine the file types supported. &nbsp;If the application desires to use the internal file transfer support of the Source, the <span style="font-style: italic;">FileType</span> argument denotes one of the following values found in the <a href="dtwain_file_transfer_constants.htm">DTWAIN File Transfer Contents</a> (Source Internal File Support) Any value that is retrieved from DTWAIN_EnumFileXferFormats can be used for <span style="font-style: italic;">FileType</span>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>When calling DTWAIN_AcquireFile or DTWAIN_AcquireFileEx and specifying the <span style="font-weight: bold;">DTWAIN_USESOURCEMODE</span> flag, the Source is responsible for the file transfer, and DTWAIN provides no other support except to initiate the transfer. &nbsp;Problems with improper files being generated, incorrect bitmaps, etc. are not the responsibility of DTWAIN when specifying DTWAIN_USESOURCEMODE.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<hr noshade size=1 style="color : #000000"><p><span style="font-weight: bold; text-decoration: underline;">Job Control</span></p>
<p>If job control is used, where each acquisition job (a set of pages) is separated by a patch code (or job separator sheet), DTWAIN has the ability to save each job as a single multipage image file. &nbsp;To turn on job control, a) the device must support job control, b) the <a href="dtwain_setjobcontrol.htm">DTWAIN_SetJobControl</a>( ) function must be called with a value other than DTWAIN_JC_NONE, and c) DTWAIN_EnableJobFileHandling must be called with a TRUE argument.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Since pages and jobs are interchangeable in describing the file naming conventions (see below), the description will contain phrases such as "page/job" or "pages/jobs".</p>
<hr noshade size=1 style="color : #000000"><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; text-decoration: underline;">Multiple Page Image Retrieval</span></p>
<p>If your device can acquire more than one page per acquisition (for example, a scanner equipped with a document feeder), DTWAIN supports saving all the pages acquired to a multi-page TIFF, DCX, PDF, or PostScript file. &nbsp;However, if a single page file type is used (for example, BMP, PNG, PSD, JPEG, single page TIFF files, etc.), there can be multiple pages being acquired where each page will be saved to a separate file.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>When acquiring more than one page/job when DTWAIN_AcquireFile is called, DTWAIN has special rules as to what the filenames should be for each page/job. &nbsp;If you are acquiring images using an automatic document feeder, the file names for the <span style="font-style: italic;">FileControlFlag </span>parameter are handled with the following rules:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>If the DTWAIN_USEPROMPT<span style="font-weight: bold;"> </span>option is used, the Windows File Save dialog box will appear after every new page (or job if job control is used) is retrieved. &nbsp;This technique allows you to name your pages/jobs "on the fly". &nbsp;The drawback is that the retrieval is paused when the file dialog window is displayed, and the retrieval won't continue until the user enters a name. &nbsp;This means that if you are scanning 50 pages/jobs, you will have to sit through 50 File Save dialog boxes.  </td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>If the DTWAIN_USENAME option is used, the names found in the <span style="font-style: italic;">FileNames</span><span style="font-style: italic; font-weight: bold;"> </span>parameter<span style="font-style: italic;"> </span>will be used for each page/job. &nbsp;When writing to a file using DTWAIN_USENAME or DTWAIN_USELONGNAME, DTWAIN <span style="text-decoration: underline;">will not</span> check if the file already exists, and will overwrite any existing file. &nbsp;If the existing file is read-only or it cannot be deleted, DTWAIN will skip over this file (since there was a creation error) and continue with the next page/job.</td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<hr noshade size=1 style="color : #000000"><p>&nbsp;</p>
<p><span style="font-weight: bold; text-decoration: underline;">File Naming when images acquired exceeds the number of file names specified</span></p>
<p>There are two methods of file naming done for DTWAIN_AcquireFile if the number of images (or jobs) acquired exceeds the number of names defined in the <span style="font-style: italic;">FileNames</span> argument.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span style="text-decoration: underline;">File naming using DTWAIN_SetFileAutoIncrement</span></td></tr></table></div><p>The <a href="dtwain_setfileautoincrement.htm">DTWAIN_SetFileAutoIncrement</a> function sets the "auto-incrementing" feature of DTWAIN file naming. &nbsp;This is discussed in depth in the DTWAIN_SetFileAutoIncrement topic.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span style="text-decoration: underline;">File naming without using DTWAIN_SetFileAutoIncrement</span></td></tr></table></div><p>This option allows you to set up all of the names for each page or job prior to actually retrieving the data. &nbsp;When the retrieval starts, the first name found in <span style="font-style: italic;">FileNames</span> is used as the file name for the first page/job, the second name found in <span style="font-style: italic;">FileNames</span> is used for the second page/job, etc. &nbsp;If the number of names found in <span style="font-style: italic;">FileNames</span> are less than the number of acquired pages/jobs, the files are named using the page number (job number) as the suffix for the file name. &nbsp;For example if there are 2 names in <span style="font-style: italic;">FileNames</span> named SCAN.BMP and SCANTWO.BMP respectively, and there are three pages that are acquired, the names of the files are SCAN.BMP, SCANTWO.BMP, and SCANTWO3.BMP.</p>
<p>&nbsp;</p>
<p>If the DTWAIN_USELONGNAME is used along with one of the above options, DTWAIN will generate a long file name if the new name exceeds the DOS 8.3 filename naming convention. &nbsp;If this option is not used, DTWAIN always tries to fit the page number within the 8.3 limit. &nbsp; For example, if DTWAIN has to create a file based on the second page acquired, and the base file name 'DTWAINSCAN.BMP' is used, the DTWAIN_USELONGNAME option will create the name 'DTWAINSCAN2.BMP'. &nbsp;If the option is not used, the name 'DTWAINS2.BMP' is created.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<hr noshade size=1 style="color : #000000"><p><span style="font-weight: bold; text-decoration: underline;">Changing the file name during acquisition</span></p>
<p>There may be situations where you want to control the naming of each image file after the image has been acquired, but has not yet been saved. &nbsp;To do this, your application must trap the DTWAIN <a href="processing_acquisition_message.htm">notification</a> <span style="font-weight: bold;">DTWAIN_TN_FILENAMECHANGING</span>. &nbsp;During this notification, the application can call <a href="dtwain_getsavefilename.htm">DTWAIN_GetSaveFileName</a> to retrieve the name of the file that will be saved, and <a href="dtwain_setsavefilename.htm">DTWAIN_SetSaveFileName</a> to set the file name to a different name.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<hr noshade size=1 style="color : #000000"><p><span style="font-weight: bold; text-decoration: underline;">Error Processing</span></p>
<p>Most file related errors are sent as notifications to your application. &nbsp;DTWAIN_AcquireFile will always return TRUE if the TWAIN device acquires the image successfully, even if the file has not been saved for some reason. &nbsp;If you want to see if any errors occurred during the file saving process, you must process <a href="processing_acquisition_message.htm">notifications</a> and check if the following notifications are sent:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>DTWAIN_TN_FILEPAGESAVEERROR</p>
<p>DTWAIN_TN_FILEPAGESAVEOK</p>
<p>DTWAIN_TN_FILESAVEOK</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>These codes are discussed in the <a href="dtwain_notification_codes.htm">notification code section</a>.</p>
<hr noshade size=1 style="color : #000000"><p><span style="font-weight: bold; text-decoration: underline;">Compatibility Issues with DTWAIN_USEPROMPT</span></p>
<p>When specifying DTWAIN_USEPROMPT for some Sources, The Windows "Save As" dialog box may hang. &nbsp;This is because some Source's are intercepting messages that the dialog box needs to operate correctly. &nbsp;For these Sources, the only workaround is to either not use DTWAIN_USEPROMPT and specify the filenames, or your application can display the "Save As" dialog before calling DTWAIN_AcquireFile or DTWAIN_AcquireFileEx to get the name to be used.  </p>
<p>&nbsp;</p>
<p>Depending on the language, there are various ways to display your own "Save As" dialog. &nbsp;For general purposes, the Windows API function <span style="font-weight: bold;">GetSaveFileName</span> is used to display the dialog. &nbsp;Please consult your programmer's reference for more information.</p>
<hr noshade size=1 style="color : #000000"><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p><a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_995107139X, true);" class="popuplink">State 4</a> (if Source is not opened)</p>
<p>State <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_1530542323X, true);" class="popuplink">5</a>, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_831869247, true);" class="popuplink">6</a>, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_1591487050X, true);" class="popuplink">7</a></p>
<p>State 4 (if Source is closed after acquisitions)</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a></p>
<p><a href="selectingthetwainsource.htm">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm">Acquiring Images</a></p>
<p>&nbsp;</p>

</td></tr></table>

</body>
</html>
