<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_GetAcquireStripData</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_getacquirestripdata.htm"; }
  else { parent.quicksync('a5.123'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p><span class="f_Heading1">DTWAIN_GetAcquireStripData</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_getacquirestripbuffer.htm">Previous</a>&nbsp;
     <a href="dtwain_getacquirestripsizes.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <span style="font-weight: bold;">DTWAIN_GetAcquireStripData</span> function gets the information concerning the current strip that was acquired when a <a href="bufferedtransfer.htm">buffered transfer</a> is in progress.</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_BOOL DTWAIN_GetAcquireStripData (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">DTWAIN_SOURCE</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpCompression,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpBytesPerRow,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpColumns,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpRows,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpXOffset,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpYOffset,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="129" style="width:129px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="131" style="width:131px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpBytesWritten </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">An open <a href="twain_data_source.htm">TWAIN Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">lpCompression</span></p>
<p style="margin: 0px 0px 0px 15px;">Pointer to a LONG that will receive the compression used, or NULL if this parameter should be ignored.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">lpBytesPerRow</span></p>
<p> &nbsp; Pointer to a LONG that will receive the number of uncompressed bytes in each row, or NULL if this parameter should be ignored.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">lpColumns</span></p>
<p> &nbsp; Pointer to a LONG that will receive the number of uncompressed columns (in pixels) in the buffer, or NULL if this parameter should be ignored.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">lpRows</span></p>
<p> &nbsp; Pointer to a LONG that will receive the number of uncompressed rows (in pixels) in the buffer, or NULL if this parameter should be ignored.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">lpXOffset</span></p>
<p> &nbsp; Pointer to a LONG that will receive how far from the left edge the data in the buffer is inset, or NULL if this parameter should be ignored.  </p>
<p>&nbsp;</p>
<p><span style="font-style: italic;">lpYOffset</span></p>
<p> &nbsp; Pointer to a LONG that will receive how far from the top edge the data in the buffer is inset, or NULL if this parameter should be ignored.  </p>
<p>&nbsp;</p>
<p><span style="font-style: italic;">lpBytesWritten</span></p>
<p> &nbsp; Pointer to a LONG that will receive the number of bytes written in the buffer, or NULL if this parameter should be ignored.  </p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>The return value is <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, true);" class="popuplink">TRUE</a> if successful. &nbsp;Otherwise <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, true);" class="popuplink">FALSE</a><span style="font-weight: bold;"> </span>is returned.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>The <span style="font-weight: bold;">DTWAIN_GetAcquireStripData</span> function gets the data that describes the latest strip of data that was transferred when the buffered memory transfer has been invoked. &nbsp;DTWAIN_GetAcquireStripData should be called only when an application receives the DTWAIN_TN_TRANSFERSTRIPDONE and DTWAIN_TN_ACQUIREDONE notifications. &nbsp;The application must process <a href="processing_acquisition_message.htm">DTWAIN Notifications</a> to use this function correctly.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>For most purposes, this function is used when an application decides to handle the strips of data that are acquired for buffered transfers by installing a user-defined buffer. &nbsp;However, DTWAIN_GetAcquireStripData can be used even if there is no user-defined buffer. &nbsp; For more information and an example, please read the section in the user manual <a href="usingauser_definedbuffer.htm">Using a User-Defined Buffer and Buffered Transfers</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Below is a definition of the values for the strip of data:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="1" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold; text-decoration: underline;">Strip Component</span></p>
</td>
<td valign="top" width="596" style="width:596px;"><p><span style="font-weight: bold; text-decoration: underline;">Definition</span></p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold;">Compression</span></p>
</td>
<td valign="top" width="596" style="width:596px;"><p>The compression method used to process the data being transferred. &nbsp; This will be equal to one of the <a href="dtwain_compression_constants.htm">DTWAIN Compression</a> constants.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold;">BytesPerRow</span></p>
</td>
<td valign="top" width="596" style="width:596px;"><p>The number of uncompressed bytes in each row of the piece of the image being described in the buffer.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold;">Columns</span></p>
</td>
<td valign="top" width="596" style="width:596px;"><p>The number of uncompressed columns (in pixels) in this buffer.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold;">Rows</span></p>
</td>
<td valign="top" width="596" style="width:596px;"><p>The number or uncompressed rows (in pixels) in this buffer.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold;">XOffset</span></p>
</td>
<td valign="top" width="596" style="width:596px;"><p>How far, in pixels, the left edge of the piece of the image being described by this structure is inset from the "left" side of the original image. If the Source is transferring in "strips", this value will equal zero. &nbsp;Since DTWAIN currently only supports strips, this value will always equal 0.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold;">YOffset</span></p>
<p>&nbsp;</p>
</td>
<td valign="top" width="596" style="width:596px;"><p>Same as XOffset, but the measure is in pixels from the "top" of the original image to the upper edge of the strip.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="169" style="width:169px;"><p><span style="font-weight: bold;">BytesWritten</span></p>
</td>
<td valign="top" width="596" style="width:596px;"><p>The number of bytes written into the transfer buffer. </p>
<p>&nbsp;</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Bufffered images are acquired when a call to </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>DTWAIN_AcquireBuffered is invoked</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>DTWAIN_AcquireFile or DTWAIN_AcquireFileEx is called with the DTWAIN_USEBUFFERED flag is used, </td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>DTWAIN_AcquireToClipboard when DTWAIN_USEBUFFERED flag is used.</td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>The Source must be in State 6 or 7.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><a href="selectingthetwainsource.htm">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><a href="dtwain_acquirebuffered.htm">DTWAIN_AcquireBuffered</a> / <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a> /  <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a>/ <a href="dtwain_acquiretoclipboard.htm">DTWAIN_AcquireToClipboard</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm">Buffered Image Transfer Support</a></p>

</td></tr></table>

</body>
</html>
