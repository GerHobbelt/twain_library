<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>Creating Searchable Text in PDF</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?creating_searchable_text_in_pd.htm"; }
  else { parent.quicksync('a3.1.24.9'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Creating Searchable Text in PDF</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="using_ocr_and_twain.htm">Previous</a>&nbsp;
     <a href="ocr_capability_listings.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a> and <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a> allows an application to acquire images from a TWAIN device, and store those images as PDF files. &nbsp;If an OCR engine is available, the PDF file can be created with searchable PDF text. &nbsp;The text is generated by the OCR recognition of the acquired image for any text elements, and these text elements will be added to the PDF as searchable text. &nbsp; The resulting PDF page will contain the image, plus any text that was recognized by the OCR engine. &nbsp;The searchable text will be "invisible" text, i.e. the text will be part of the PDF page and searchable, but will not be visible (the image isn't altered, just the generated text will not be visible).</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold; text-decoration: underline;">Searching for Text and Caveats</span></p>
<p>&nbsp;</p>
<p>Starting with version <span style="font-weight: bold;">3.1.0.0</span> of DTWAIN, the searchable text is placed in the approximate area of the image where the text is found. &nbsp; This means that when you do a text search in Adobe Acrobat (see next paragraph for more information on this) or any other PDF program that displays PDF files, the PDF program will "highlight" the appropriate text. &nbsp;This by no means &nbsp;simple feat -- most of the time, the OCR engine that analyzed the image will give accurate information on the text height, placement, etc., so that DTWAIN has correct information on where to place the text in the PDF page. &nbsp;This works most of the time, however there will be the odd piece of text that will not position correctly (but still will be found). &nbsp;Therefore, the accuracy of the OCR engine is highly important on how well DTWAIN puts together the searchable text in terms of the actual characters, positional information, font information, etc.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">Important for Adobe Acrobat users:</span></p>
<p>&nbsp;<br>
It has come to our attention that Adobe Acrobat's search feature does not work correctly in many instances, thereby not finding text that is within the PDF document. &nbsp; Adobe Acrobat is able to process the text (highlight, extract, etc.), but not search correctly 100% of the time. &nbsp;We are attempting to address this issue with Adobe. &nbsp; To that extent, we have had no issues with other non-Adobe, PDF rendering program's text search feature. &nbsp;One such PDF program is <span style="font-weight: bold;">NitroPDF</span> by <span style="font-weight: bold;">Nitro PDF Software</span>. &nbsp;Also, any program that merely searches or extracts PDF text within a document (one that can recognize compressed streams within PDF) will extract correctly. &nbsp; For example, the free <span style="font-weight: bold;">GhostView </span>program that can view PostScript and PDF files has a text extraction feature that gathers all the text in a PDF document and saves it to a text file.  </p>
<p>&nbsp;</p>
<p> We are sorry for this inconvenience, but this issue is from what we have discovered, an issue with Acrobat's erratic text search, &nbsp;and not DTWAIN.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold; text-decoration: underline;">Searchable Text Basics</span></p>
<p>&nbsp;</p>
<p>By default, when DTWAIN creates a PDF file, the PDF file consists only of image data that cannot be searched for text. &nbsp;One way to add text is to call <a href="dtwain_addpdftext.htm">DTWAIN_AddPDFText</a> for each page that is generated. &nbsp;Another way to add text is to let DTWAIN automatically generate the text for a page by using the OCR engine for the text generation.  </p>
<p>&nbsp;</p>
<p>To allow DTWAIN to automatically generate searchable text, two functions must be called. &nbsp;The first function is <a href="dtwain_setpdfocrmode.htm">DTWAIN_SetPDFOCRMode</a>. &nbsp;This function tells DTWAIN to generate PDF files with searchable text (if there is an available OCR engine) whenever DTWAIN_AcquireFile or DTWAIN_AcquireFileEx is called, and the file type to acquire is DTWAIN_PDF or DTWAIN_PDFMULTI.  </p>
<p>&nbsp;</p>
<p>The second function is <a href="dtwain_setpdfocrconversion.htm">DTWAIN_SetPDFOCRConversion</a>. &nbsp;This function is used to set up the OCR engine when a PDF page is acquired and what options to set for each type of page. &nbsp; The DTWAIN_SetPDFOCRConversion function tells DTWAIN the following information: &nbsp;for each PDF page type (black/white or color), the OCR options to use when creating the searchable text. &nbsp;This means, for example, if you are acquiring color PDF files, and the OCR engine can only process black and white images, DTWAIN will:</p>
<p>&nbsp;</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="15"><span style="font-size: 10pt; font-family: 'Arial'; color: #000000;">1.</span></td><td>Create a temporary image file</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="15"><span style="font-size: 10pt; font-family: 'Arial'; color: #000000;">2.</span></td><td>Start the OCR engine and scan the temporary image file for text</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="15"><span style="font-size: 10pt; font-family: 'Arial'; color: #000000;">3.</span></td><td>Delete the temporary image</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="15"><span style="font-size: 10pt; font-family: 'Arial'; color: #000000;">4.</span></td><td>Store the text in the PDF page.</td></tr></table></div><p>&nbsp;</p>
<p>Since DTWAIN always creates temporary image files when creating PDF files, regardless of whether OCR processing is being used, steps 1 and 3 above will be repeated for OCR engines that cannot process DTWAIN's original black/white and color image formats. &nbsp;When acquiring to PDF files, DTWAIN will <span style="text-decoration: underline;">always</span> generate a temporary, uncompressed TIFF (DTWAIN_TIFFNONE) files for PDF pages, and for color pages, a temporary JPEG (DTWAIN_JPEG) files.</p>
<p>&nbsp;</p>
<p>If your OCR engine supports processing uncompressed TIFF files for black/white images, then it is wise to choose DTWAIN_TIFFNONE as the mode your OCR engine should use when processing black/white PDF pages. &nbsp;Similarly, if your OCR engine supports JPEG images, select this OCR image type when acquiring color PDF pages. &nbsp;The reason being that DTWAIN does not have to create another temporary image file to allow your OCR engine to scan the text correctly, and can just use the temporary file that DTWAIN always generates when acquiring to PDF files.</p>
<p>&nbsp;</p>
<p>Otherwise, DTWAIN will convert the black/white or color image to a temporary image type that your OCR engine supports, and processes the page.  </p>
<p>&nbsp;</p>
<p>Your OCR engine must support processing at least one of the following image types for proper processing of searchable PDF text:</p>
<p>&nbsp;</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="175" style="width:175px;"><p><span style="font-weight: bold;">DTWAIN_TIFFNONE</span></p>
</td>
<td valign="top" width="667" style="width:667px;"><p>Uncompressed TIFF</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="175" style="width:175px;"><p><span style="font-weight: bold;">DTWAIN_TIFFG3</span></p>
</td>
<td valign="top" width="667" style="width:667px;"><p>CCITTFaxDecode Group 3 TIFF</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="175" style="width:175px;"><p><span style="font-weight: bold;">DTWAIN_TIFFG4</span></p>
</td>
<td valign="top" width="667" style="width:667px;"><p>CCITTFaxDecode Group 4 TIFF</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="175" style="width:175px;"><p><span style="font-weight: bold;">DTWAIN_TIFFLZW</span></p>
</td>
<td valign="top" width="667" style="width:667px;"><p>TIFF/LZW compression</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="175" style="width:175px;"><p><span style="font-weight: bold;">DTWAIN_BMP</span></p>
</td>
<td valign="top" width="667" style="width:667px;"><p>Windows Bitmap file</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="175" style="width:175px;"><p><span style="font-weight: bold;">DTWAIN_JPEG</span></p>
</td>
<td valign="top" width="667" style="width:667px;"><p>JPEG file -- color PDF pages only</p>
</td>
</tr>
</table>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Example:</p>
<hr noshade size=1 style="color : #000000"><p>#include "dtwain.h"</p>
<p>&nbsp;</p>
<p>void GetOCRText( )</p>
<p>{</p>
<p> &nbsp; &nbsp;LONG nFormats;</p>
<p> &nbsp; &nbsp;int isSupported = 0;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; <a href="dtwain_ocrengine.htm">DTWAIN_OCRENGINE</a> SelectedEngine;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; <a href="dtwain_source.htm">DTWAIN_SOURCE</a> SelectedSource;</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; char *filename = "MyText.txt";</span></p>
<p>&nbsp;</p>
<p> &nbsp; &nbsp;/* Initialize DTWAIN Library */</p>
<p> &nbsp;  <a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a>( );</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p> &nbsp; &nbsp;/* Select the default TWAIN source */ </p>
<p> &nbsp; &nbsp;SelectedSource = <a href="dtwain_selectdefaultsource.htm">DTWAIN_SelectDefaultSource</a>( );</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p> &nbsp; &nbsp;if ( SelectedSource == 0 )</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;return; &nbsp;/* No Source was selected */</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p> &nbsp; &nbsp;/* Initialize the OCR interface */</p>
<p> &nbsp;  <a href="dtwain_initocrinterface.htm">DTWAIN_InitOCRInterface</a>( );</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p> &nbsp; &nbsp;/* Select the default OCR engine */ </p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; SelectedEngine = <a href="dtwain_selectdefaultocrengine.htm">DTWAIN_SelectDefaultOCREngine</a>( );</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; if ( SelectedEngine != 0 )</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; {</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Tell DTWAIN to create searchable text when acquiring to PDF files */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_setpdfocrmode.htm">DTWAIN_SetPDFOCRMode</a>( SelectedSource, TRUE );</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Set the PDF OCR conversion parameters */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* We know that our OCR engine has the ability to process 1 bpp BMP images for text, </span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; so we will inform the PDF processing that we want the OCR engine to</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; generate a temporary 1-bpp BMP image for OCR processing */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_setpdfocrconversion.htm">DTWAIN_SetPDFOCRConversion</a>( SelectedEngine, DTWAIN_PDFPAGETYPE_BW, DTWAIN_BMP, DTWAIN_PT_BW, 1, DTWAIN_PDFOCR_CLEANTEXT1 );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_setpdfocrconversion.htm">DTWAIN_SetPDFOCRConversion</a>( SelectedEngine, DTWAIN_PDFPAGETYPE_COLOR, DTWAIN_BMP, DTWAIN_PT_BW, 1, DTWAIN_PDFOCR_CLEANTEXT1 );</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Start the acquisition of PDF pages from the selected TWAIN device */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a>( SelectedSource, "Searchable.pdf", DTWAIN_PDF, DTWAIN_USENAME, DTWAIN_PT_DEFAULT, 1, TRUE, TRUE, NULL );</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* if no file errors occurred, then a PDF file with searchable text was created called "Searchable.pdf" */</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; /* Destroy the TWAIN interface */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; <a href="dtwain_sysdestroy.htm">DTWAIN_SysDestroy</a>( );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;}</span></p>
<hr noshade size=1 style="color : #000000"><p>&nbsp;</p>

</td></tr></table>

</body>
</html>
