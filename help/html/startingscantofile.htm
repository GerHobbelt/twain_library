<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>Using DTWAIN_TwainSave</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?startingscantofile.htm"; }
  else { parent.quicksync('a3.1.2'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Using DTWAIN_TwainSave</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="welcometopic.htm">Previous</a>&nbsp;
     <a href="twainsavereturncodes.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The following code snippets in the manual showing <span style="font-weight: bold;">DTWAIN_TwainSave</span> assumes you are using 'C' or C++. &nbsp;Please change the syntax of the calls being used to match the language that you're using. &nbsp;For example:</p>
<p>&nbsp;</p>
<p>DTWAIN_TwainSave( "-f test.tif ")</p>
<p>&nbsp;</p>
<p>In <span style="font-weight: bold;">Visual Basic 6.0</span> and below would be:</p>
<p>&nbsp;</p>
<p>DTWAIN_TwainSave "-f test.tif"</p>
<p>&nbsp;</p>
<hr noshade size=1 style="color : #000000"><p><span style="color: #ff0000;">The following advisory is only necessary for C, C++, and for any other computer language you may be using that requires backslashes within strings to be specified by two backslashes, and double quotes within strings to be properly escaped. &nbsp;  </span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;">If you are not programming in the C or C++ language, you will still need to embed double quotes and backslashes where needed inside of strings. &nbsp;Consult the rules of your language to properly insert double quotes and backslashes within strings.</span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;">End of advisory....</span></p>
<hr noshade size=1 style="color : #000000"><p>&nbsp;</p>
<p>In general, you invoke a DTWAIN_TwainSave command-line as follows:</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_TwainSave("options")</span></p>
<p>&nbsp;</p>
<p>where <span style="font-weight: bold;">options</span> are the various command-line options that are available. &nbsp;All the command options are preceded with a hyphen (<span style="font-weight: bold;">-</span>) or with a forward slash (/). &nbsp;For example, these two commands do exactly the same thing:</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_TwainSave("/f test.tif /noui"); </span></p>
<p><span style="font-weight: bold;">DTWAIN_TwainSave("-f test.tif -noui");</span></p>
<p>&nbsp;</p>
<p>For the remainder of this documentation, the commands will be preceded with a hyphen.</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">Very important:  </span></p>
<p>&nbsp;</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>The options are <span style="font-weight: bold;">case-sensitive</span>. &nbsp;For example, an option of <span style="font-weight: bold;">-p </span> and <span style="font-weight: bold;">-P</span> are two different options.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>Options that have spaces in the arguments must be enclosed in double quotes:</td></tr></table></div><p><span style="width:48px">&nbsp;</span>Example - set the file name to c:\My Documents:</p>
<p><span style="width:48px">&nbsp;</span><span style="font-weight: bold;">-f "c:\My Documents"</span></p>
<p>&nbsp;</p>
<p><span style="width:48px">&nbsp;</span>Example - set the area to acquire as a 3 x 3 inch square:</p>
<p><span style="width:48px">&nbsp;</span><span style="font-weight: bold;">-area "0 0 3 3 inch"</span></p>
<p>&nbsp;</p>
<hr noshade size=1 style="color : #000000"><p><span style="font-weight: bold;">For C/C++ programmers:</span></p>
<p>Note that many times, you may have to insert double quotes in the command-string. &nbsp;This requires you to properly use <span style="font-weight: bold;">escape codes</span> to enter the string. &nbsp;For example:</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_TwainSave("-f \"A file name that contains spaces.bmp\" ");</span></p>
<p>&nbsp;</p>
<p>Note that for the above, since the file name used contains spaces, it is necessary to use double quotes around the file name. &nbsp;For C/C++ programs, to embed quotes, use the escape sequence <span style="font-weight: bold;">\"</span>. &nbsp; In addition, for C/C++ the backslash character must also be escaped using two backslash characters. &nbsp;For example:</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_TwainSave("-f c:\\MyDirectory\\MyFile.bmp")</span></p>
<p>&nbsp;</p>
<p>This is highly important for the C/C++ programmer to realize, since many string-related bugs can occur with an improperly escaped string sequence.</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;">If you are not programming in the C or C++ language, you will still need to embed double quotes and backslashes where needed. &nbsp;Consult the rules of your language to properly insert double quotes within strings.</span></p>
<p>&nbsp;</p>
<hr noshade size=1 style="color : #000000"><p>&nbsp;</p>
<p>The following calls DTWAIN_TwainSave with the option to open the TWAIN "Select Device" dialog box:</p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt; font-weight: bold;">DTWAIN_SysInitialize( );</span></p>
<p><span style="font-size: 9pt; font-weight: bold;">DTWAIN_TwainSave("-f test.bmp");</span></p>
<p><span style="font-size: 9pt; font-weight: bold;">DTWAIN_SysDestroy( );</span></p>
<p>&nbsp;</p>
<p>Note the usage of DTWAIN_SysInitialize to initialize the DTWAIN library, and DTWAIN_SysDestroy to properly shutdown DTWAIN. &nbsp;These two functions are mandatory when utilizing the DTWAIN library.  </p>
<p>&nbsp;</p>
<p>Once the device is selected, the call to DTWAIN_TwainSave allows the device's user interface will be displayed, allowing you to start the scanning or image retrieval process. </p>
<p>&nbsp;</p>
<p><img src="clip0014.jpg" width="327" height="179" border="0" alt="clip0014"></p>
<p>&nbsp;</p>
<p>The number of items that appear in the "Select TWAIN device" dialog box depends on the number of installed drivers.</p>
<p>&nbsp;</p>
<p>The image retrieved will be saved in Windows bitmap (BMP) format, and the name of the file will be "test.bmp".</p>
<p>&nbsp;</p>
<p>Various options are available to save to a different file format, select the device without the "Select TWAIN device" dialog from displaying, retrieving the image without displaying the device's user interface, acquiring multiple pages, etc. &nbsp;It is recommended that you start with the basic set of command-line options (for example, acquire to another image type, change the file name, etc), and then add the more advanced options (for example, job control) as you get more experienced with using DTWAIN_TwainSave.</p>
<p>&nbsp;</p>
<p><a href="commandoverview.htm">DTWAIN_TwainSave options</a></p>

</td></tr></table>

</body>
</html>
