<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_GetCustomDSData</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DTWAIN_GetCustomDSData" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_getcustomdsdata.htm"; }
  else { parent.quicksync('a5.145'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p><span class="f_Heading1">DTWAIN_GetCustomDSData</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_getcurrentacquiredimage.htm">Previous</a>&nbsp;
     <a href="dtwain_getdeviceevent.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <span style="font-weight: bold;">DTWAIN_GetCustomDSData</span> retrieves the custom data from a Source.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">HANDLE DTWAIN_GetCustomDSData (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="131" style="width:131px;"><p><span style="font-weight: bold;">DTWAIN_SOURCE</span></p>
</td>
<td valign="top" width="129" style="width:129px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="131" style="width:131px;"><p><span style="font-weight: bold;">LPBYTE</span></p>
</td>
<td valign="top" width="129" style="width:129px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpData,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="131" style="width:131px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="129" style="width:129px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">nSize,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="131" style="width:131px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td valign="top" width="129" style="width:129px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">pActualSize,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="131" style="width:131px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="129" style="width:129px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">nFlags </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters:</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">An open <a href="twain_data_source.htm">TWAIN Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">lpData</span></p>
<p style="margin: 0px 0px 0px 15px;">A pointer to an array of BYTE's where the retrieved Source data will be copied, or NULL</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">nSize</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the number of bytes to copy to <span style="font-style: italic;">lpData.</span> &nbsp;If <span style="font-style: italic;">lpData </span> is NULL, this argument is ignored.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">pActualSize</span></p>
<p style="margin: 0px 0px 0px 15px;">On return, filled in with the actual size of the source data.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">nFlags</span></p>
<p style="margin: 0px 0px 0px 15px;">Flags to determine how to interpret the <span style="font-style: italic;">lpData</span> and <span style="font-style: italic;">nSize</span> arguments.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Returns:</span></p>
<p>A Global HANDLE to the source data or a positive number. &nbsp; If there is an error, NULL is returned.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments:</span></p>
<p><span style="font-weight: bold;">DTWAIN_GetCustomDSData</span> uses the <span style="font-weight: bold;">DAT_CUSTOMDSDATA</span> TWAIN group to retrieve the Source's custom data. &nbsp;This is usually done after the application calls the <a href="dtwain_showuionly.htm">DTWAIN_ShowUIOnly</a> function so the application can retrieve the set values. &nbsp;To test if the Source supports custom data, call <a href="dtwain_iscustomdsdatasupported.htm">DTWAIN_IsCustomDSDataSupported</a>. &nbsp;Usually mid to high-volume scanners support this type of operation.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Note: &nbsp;The format of the returned data is Source dependent and is not defined by TWAIN, therefore your application must have knowledge of the format of the data from the creator of the Source. &nbsp;Usually the manufacturer of the device has specifications as to what format the data is returned and how to interpret the data.. </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Depending on the value of the <span style="font-style: italic;">nFlags</span> argument, the return value will be the global handle to the Source data. &nbsp;The application must call the Windows API function <span style="font-weight: bold;">GlobalLock</span> to retrieve the data from the handle, and also be responsible for calling <span style="font-weight: bold;">GlobalUnlock</span> and <span style="font-weight: bold;">GlobalFree</span> to release the handle and return the memory back to the operating system.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the application does not desire to do the memory management, an alternative is for the application to specify that the data be placed in a buffer pointed to by the <span style="font-style: italic;">lpData</span> parameter. &nbsp;The <span style="font-style: italic;">nSize</span> argument determines how many bytes of data to copy to <span style="font-style: italic;">lpData</span>. &nbsp;If <span style="font-style: italic;">nSize</span> is -1, all of the data must be copied to <span style="font-style: italic;">lpData</span>. &nbsp;The application must make sure that there is enough room to copy the data. </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the application wants to know the size of the data so as to set aside the correct amount of memory, specify 0 as the <span style="font-style: italic;">nSize</span> value and call DTWAIN_GetCustomDSData. &nbsp;The <span style="font-style: italic;">pActualSize</span> argument that is returned will be the size of the data. &nbsp;A subsequent call to DTWAIN_GetCustomDSData with <span style="font-style: italic;">nSize</span> equal to this value will copy the data to <span style="font-style: italic;">lpData</span>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">pActualSize</span> argument is always filled in with the actual size in bytes of the Source data. &nbsp;If <span style="font-style: italic;">pActualSize</span> is NULL, no value is copied.</p>
<p>&nbsp;</p>
<p>The <span style="font-style: italic;">nFlags</span> argument must be one of the following values:</p>
<p><span style="font-weight: bold;">DTWAINGCD_RETURNHANDLE</span> </p>
<p><span style="font-weight: bold;">DTWAINGCD_COPYDATA</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DTWAINGCD_RETURNHANDLE</span> setting ignores the <span style="font-style: italic;">lpData </span>and <span style="font-style: italic;">nSize</span> arguments, and only returns a handle to the data. &nbsp;The application is then responsible for locking the handle with GlobalLock( ) and later freeing the handle with GlobalUnlock / GlobalFree( ).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DTWAINGCD_COPYDATA</span> uses the <span style="font-style: italic;">lpData</span> and <span style="font-style: italic;">nSize</span> arguments to copy the source data to <span style="font-style: italic;">lpData.  </span>If <span style="font-style: italic;">nSize</span> is -1, all of the data is copied to <span style="font-style: italic;">lpData</span>. &nbsp;If <span style="font-style: italic;">nSize</span> is 0, the <span style="font-style: italic;">pActualSize </span>argument is filled in with the size of the data, and no data is copied. &nbsp;This is useful if you want to know the size of the Source data to determine how many bytes to reserve for <span style="font-style: italic;">lpData</span>. &nbsp;With <span style="font-weight: bold;">DTWAINGCD_COPYDATA</span> the application does not make any calls to GlobalLock( ), GlobalFree( ), etc. &nbsp;All of this memory management is handled internally by DTWAIN. &nbsp;The return value when using <span style="font-weight: bold;">DTWAINGCD_COPYDATA</span> is a positive integer on success. &nbsp;This return value is <span style="text-decoration: underline;">not</span> a valid global handle, so it cannot be freed. &nbsp; It is only for informational purposes to let your application know whether the function is successful.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To set the Source's custom data, call <a href="dtwain_setcustomdsdata.htm">DTWAIN_SetCustomDSData</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>The Source must be in <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_995107139X, true);" class="popuplink">State 4</a> or higher</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><a href="selectingthetwainsource.htm">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm">Setting / Getting Source Custom Data</a></p>
<p><a href="dtwain_source_functions.htm">Retrieving / Setting Custom Source Data</a></p>

</td></tr></table>

</body>
</html>
