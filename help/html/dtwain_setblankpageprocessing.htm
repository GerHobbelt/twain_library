<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_SetBlankPageDetection</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_setblankpageprocessing.htm"; }
  else { parent.quicksync('a5.289'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">DTWAIN_SetBlankPageDetection</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_setbitdepth.htm">Previous</a>&nbsp;
     <a href="dtwain_setblankpagedetectionst.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <span style="font-weight: bold;">DTWAIN_SetBlankPageDetection</span> function allows detection of blank pages when acquiring from a TWAIN device, and optionally allows automatic discarding of blank pages.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_BOOL DTWAIN_SetBlankPageDetection (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="134" style="width:134px;"><p><span style="font-weight: bold;">DTWAIN_SOURCE</span></p>
</td>
<td valign="top" width="126" style="width:126px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="134" style="width:134px;"><p><span style="font-weight: bold;">DTWAIN_FLOAT</span></p>
</td>
<td valign="top" width="126" style="width:126px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">threshold,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="134" style="width:134px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="126" style="width:126px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">options,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="134" style="width:134px;"><p><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td valign="top" width="126" style="width:126px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bEnable </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p>A <a href="dtwain_source.htm">DTWAIN_SOURCE</a> denoting a <a href="twain_data_source.htm">TWAIN Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">threshold</span></p>
<p>Sets the percentage of white pixels to black pixels to determine if a page is blank.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">options</span></p>
<p>Sets the auto-discard options when processing blank pages.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">bEnable</span></p>
<p>Enables/disables the blank page processing mechanism.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>The return value is <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, true);" class="popuplink">TRUE</a> if successful. &nbsp;Otherwise <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, true);" class="popuplink">FALSE</a><span style="font-weight: bold;"> </span>is returned.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>The <span style="font-weight: bold;">DTWAIN_SetBlankPageDetection </span>function allows DTWAIN to determine if an acquired page is blank. &nbsp;If the page is determined to be blank, DTWAIN can automatically discard the page (i.e. not have it sent to the application), or DTWAIN can inform your application that an acquired page is blank, and your application can decide to discard the page.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">Source</span> is the DTWAIN_SOURCE that will be used when setting the mode.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">threshold</span> parameter is the percentage that is used by DTWAIN to determine if a page is blank. &nbsp;This percentage is based on the ratio of the number of white pixels to dark or black pixels. &nbsp;For most cases, a <span style="font-style: italic;">threshold </span>value of 98.5 to 99 percent is needed for proper blank page detection. &nbsp;If your application considers dark or totally black pages as blank, then the threshold should be closer to 0% instead of 100%.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">options</span> sets the "auto-discard" feature, where DTWAIN will automatically discard blank pages when they are detected. &nbsp;The <span style="font-style: italic;">options </span>parameter can be one or a combination of the following:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_BP_AUTODISCARD_NONE</span> - This option turns off the auto-discard feature. &nbsp;In this case, DTWAIN will send a <a href="processing_acquisition_message.htm">notification</a> to your application that a blank page has been detected, and your application can decide to discard the page or not. &nbsp;Your application will get a notification immediately after the page has been acquired from the device, and once again after DTWAIN does post-processing on the returned image (for cropping, resampling, etc.). &nbsp;See later on in this topic on the notifications that are sent to your application when a blank page is detected.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_BP_AUTODISCARD_IMMEDIATE</span> - This option will automatically discard blank pages that are immediately returned from the device. &nbsp;The bitmap that is immediately returned has not been cropped or resampled by DTWAIN, but is the raw image that has been acquired from the device.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_BP_AUTODISCARD_AFTERPROCESS</span> - This option will automatically discard blank pages after they have been possibly cropped and resampled by DTWAIN. &nbsp;For example, if you have called <a href="dtwain_setacquirearea2.htm">DTWAIN_SetAcquireArea2</a>, DTWAIN needs to crop the image after it has been acquired from the device. &nbsp;If after the image has been cropped internally by DTWAIN, the resulting image is blank, then the page is blank.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_BP_AUTODISCARD_ANY -  </span>Combines <span style="font-weight: bold;">DTWAIN_BP_AUTODISCARD_IMMEDIATE</span> and <span style="font-weight: bold;">DTWAIN_BP_AUTODISCARD_AFTERPROCESS</span> options.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">bEnable</span> option turns on or off the blank page detection. &nbsp;If <span style="font-style: italic;">bEnable</span> is TRUE, then the blank page detection is turned on, else if <span style="font-style: italic;">bEnable </span>is FALSE, the blank page detection is disabled.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; text-decoration: underline;">Notifications sent to application</span></p>
<p>The following notifications are sent to your application when a blank page is detected, and the blank page detection has been turned on:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_TN_BLANKPAGEDETECTED1</span> - This notification is sent to your application when the initial page that is returned from the TWAIN device is blank. &nbsp;If you have DTWAIN_BP_AUTODISCARD_NONE in your <span style="font-style: italic;">option</span> argument when calling DTWAIN_SetBlankPageDetection, your notification handler must return either 0 to discard the page, or 1 to keep the page. &nbsp;If you used any other <span style="font-style: italic;">option</span> argument when DTWAIN_SetBlankPageDetection was called (i.e. the DTWAIN_BP_AUTODISCARD_IMMEDIATE or DTWAIN_BP_AUTODISCARD_AFTERPROCESS option(s)), then the return value from this notification is ignored by DTWAIN, and the page is automatically discarded.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_TN_BLANKPAGEDETECTED2</span> - This notification is sent to your application when the page has been adjusted (either cropped, resampled, etc.) by DTWAIN. &nbsp;If you have DTWAIN_BP_AUTODISCARD_NONE in your <span style="font-style: italic;">option</span> argument when calling DTWAIN_SetBlankPageDetection, your notification handler must return either 0 to discard the page, or 1 to keep the page. &nbsp;If you used any other <span style="font-style: italic;">option</span> argument when DTWAIN_SetBlankPageDetection was called (i.e. the DTWAIN_BP_AUTODISCARD_IMMEDIATE or DTWAIN_BP_AUTODISCARD_AFTERPROCESS option(s)), then the return value from this notification is ignored by DTWAIN, and the page is automatically discarded.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_TN_BLANKPAGEDISCARDED1</span><span style="font-style: italic; font-weight: bold;"> </span><span style="font-style: italic;">- </span>This notification is sent to inform your handler that the initial page that was returned from the TWAIN device has been discarded. &nbsp;The return value from this notification should always be 1.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_TN_BLANKPAGEDISCARDED2</span><span style="font-style: italic; font-weight: bold;"> </span><span style="font-style: italic;">- </span>This notification is sent to inform your handler that the DTWAIN-adjusted page has been discarded. &nbsp;The return value from this notification should always be 1.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; text-decoration: underline;">Examples:</span></p>
<p><span style="font-size: 9pt;"> DTWAIN_SOURCE Source;</span></p>
<p><span style="font-size: 9pt;">/* ... */</span></p>
<p><span style="font-size: 9pt;">/*1)*/ &nbsp;DTWAIN_SetBlankPageDetection( Source, 98.0, DTWAIN_BP_AUTODISCARD_NONE, TRUE ); </span></p>
<p><span style="font-size: 9pt;">/*2)*/ &nbsp;DTWAIN_SetBlankPageDetection( Source, 98.5, DTWAIN_BP_AUTODISCARD_ANY, TRUE ); </span></p>
<p><span style="font-size: 9pt;">/*3)*/ &nbsp;DTWAIN_SetBlankPageDetection( Source, 0.0, 0, FALSE ); </span></p>
<p>&nbsp;</p>
<p>The first call 1) to DTWAIN_SetBlankPageDetection allows DTWAIN to detect blank pages, and will send the DTWAIN_TN_BLANKPAGEDETECTED1 and DTWAIN_TN_BLANKPAGEDETECTED2 notifications to the application when a blank page is detected. &nbsp;The application is then responsible for returning 0 or 1 from each of these notifications, depending on whether the page should be discarded or kept.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The second call, 2), allows DTWAIN to automatically discard blank pages when a blank page is detected immediately after the page is acquired, or after DTWAIN has finished processing the file. &nbsp;Both DTWAIN_TN_BLANKPAGEDETECTED1 and DTWAIN_TN_BLANKPAGEDETECTED2 notifications are sent to the application, however no action needs to be taken by the application when processing these notifications.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The third call, 3), turns off blank page detection, since the last parameter is FALSE.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #ff0000;">If job control is also enabled, and the job relies on blank pages as job separation pages, then a combination of having DTWAIN remove blank pages and job control may produce undesired effects. &nbsp;Therefore it is recommended not to automatically discard blank pages if blank pages are also used to separate jobs.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: bold; text-decoration: underline;">Limitations</span></p>
<p>Please note that DTWAIN_SetBlankPageDetection currently has the following limitations:</p>
<p>&nbsp;</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>Detecting and discarding blank pages has full support when using <a href="dtwain_acquirenative.htm">DTWAIN_AcquireNative</a>, <a href="dtwain_acquirenativeex.htm">DTWAIN_AcquireNativeEx</a>, or <a href="dtwain_acquiretoclipboard.htm">DTWAIN_AcquireToClipboard</a> functions. &nbsp;There are no limitations when using these functions.<br>
&nbsp;</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>Detecting and discarding blank pages has partial support for <a href="dtwain_acquirebuffered.htm">DTWAIN_AcquireBuffered</a> and <a href="dtwain_acquirebufferedex.htm">DTWAIN_AcquireBufferedEx</a>. &nbsp;The compression type must be in DIB format (not TIFF, JPEG, or any other compression type that your TWAIN device may support) to guarantee that blank pages can be detected. &nbsp;To ensure that DIB's are acquired, your application can call <a href="dtwain_setcompressiontype.htm">DTWAIN_SetCompressionType</a> using DTWAIN_CP_NONE as the compression type.<br>
&nbsp;</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td>Detecting and discarding blank pages has full support when using <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a> and <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a> only when the DTWAIN_USESOURCEMODE flag is <span style="font-weight: bold;">not</span> set when calling DTWAIN_AcquireFile or DTWAIN_AcquireFileEx. &nbsp;See <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a> for more information on the various flags.</td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #ff0000;">For languages that have difficulties with DTWAIN_FLOAT parameters, the alternate function that can be used as a replacement for DTWAIN_SetBlankPageDetection is </span><span style="color: #ff0000;"><a href="dtwain_setblankpagedetectionst.htm">DTWAIN_SetBlankPageDetectionString</a>.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>None</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a></p>
<p><a href="selectingthetwainsource.htm">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="discarding_blank_pages.htm">Blank Page Detection</a></p>

</td></tr></table>

</body>
</html>
