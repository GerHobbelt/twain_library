<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_SetDSMSearchOrder</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_setdsmsearchorder.htm"; }
  else { parent.quicksync('a5.306'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">DTWAIN_SetDSMSearchOrder</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_setdevicenotifications.htm">Previous</a>&nbsp;
     <a href="dtwain_setcustomfilesave.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <span style="font-weight: bold;">DTWAIN_SetDSMSearchOrder</span> function sets the directories that are searched whenever DTWAIN attempts to locate and load the <a href="selecting_twain_data_source_ma.htm">TWAIN Data Source Manager</a>.</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_BOOL DTWAIN_SetDSMSearchOrder ( LONG </span><span style="font-style: italic;">SearchOrder </span><span style="font-weight: bold;">);</span></p>
<p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">SearchOrder</span></p>
<p style="margin: 0px 0px 0px 15px;">A LONG value denoting the order of directory searching when attempting to locate and load the TWAIN Data Source Manager.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>The return value is <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, true);" class="popuplink">TRUE</a> if successful. &nbsp;Otherwise <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, true);" class="popuplink">FALSE</a><span style="font-weight: bold;"> </span>is returned.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>The DTWAIN_SetDSMSearchOrder function allows the application to set the order of the directories searched when attempting to locate and load the TWAIN Data Source Manager (DSM) File. &nbsp;This file is usually TWAIN_32.DLL or TWAINDSM.DLL, depending on whether the application is 32-bit or 64-bit.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The functions that use the DSM search order set by DTWAIN_SetDSMSearchOrder are <a href="dtwain_istwainavailable.htm">DTWAIN_IsTwainAvailable</a>, <a href="dtwain_getdsmfullname.htm">DTWAIN_GetDSMFullName</a>, and <a href="dtwain_starttwainsession.htm">DTWAIN_StartTwainSession</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">SearchOrder</span> specifies which set of directories to search and the order of searching the directories. &nbsp; The following values are available to <span style="font-style: italic;">SearchOrder.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px; border-collapse: collapse;">
<tr style="text-align:left;vertical-align:top;">
<td valign="bottom" width="252" style="width:252px; border: solid 1px #000000;"><p style="text-align: center;"><span style="font-style: italic; font-weight: bold;">SearchOrder</span><span style="font-weight: bold;"> constant name</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;"><span style="font-weight: bold;">Value</span></p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;"><span style="font-weight: bold;">Directory and Search Order</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_WSO</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">0</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">WINDOWS, SYSTEM, OS search</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_WOS</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">1</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">WINDOWS, OS search, SYSTEM</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_SWO</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">2</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">SYSTEM, WINDOWS, OS search</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_SOW</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">3</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">SYSTEM, OS search, WINDOWS</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_OWS</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">4</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">OS search, WINDOWS, SYSTEM</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_OSW</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">5</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">OS search, SYSTEM, WINDOWS</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_W</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">6</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">WINDOWS only</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_S</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">7</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">SYSTEM only</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_O</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">8</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">OS search only</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_WS</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">9</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">WINDOWS, SYSTEM</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_WO</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">10</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">WINDOWS, OS search</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_SW</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">11</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">SYSTEM, WINDOWS</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_SO</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">12</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">SYSTEM, OS search</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_OW</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">13</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">OS search, WINDOWS</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="252" style="width:252px; border: solid 1px #000000;"><p><span style="color: #010001;">DTWAIN_TWAINDSMSEARCH_OS</span></p>
</td>
<td valign="bottom" width="80" style="width:80px; border: solid 1px #000000;"><p style="text-align: center;">14</p>
</td>
<td valign="bottom" width="248" style="width:248px; border: solid 1px #000000;"><p style="text-align: center;">OS search, SYSTEM</p>
</td>
</tr>
</table>
</div>
<p>&nbsp;</p>
<p>The WINDOWS and SYSTEM denote the <span style="font-weight: bold;">WINDOWS</span> and <span style="font-weight: bold;">SYSTEM</span> directories, as specified by the GetWindowsDirectory and GetSystemDirectory Windows API functions, respectively. &nbsp;The <span style="font-weight: bold;">OS search </span>uses the search path logic that the Windows Operating System uses to search for DLL files. &nbsp;See <a href="twain_data_source_manager.htm">Locating and Loading the TWAIN DSM</a> for more information on the WINDOWS, SYSTEM, and OS searches.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The DTWAIN_SetDSMSearchOrder function can be called before calling <a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a>, and before calling <a href="dtwain_istwainavailable.htm">DTWAIN_IsTwainAvailable</a>. &nbsp;The <a href="dtwain_istwainavailable.htm">DTWAIN_IsTwainAvailable</a> function will use the current search order set by DTWAIN_SetDSMSearchOrder to check if TWAIN is available on the user's system.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If multiple directories are to be searched, the first directory found that contains the TWAIN DSM will be used. &nbsp;For example, DTWAIN_TWAINDSMSEARCH_WSO will search the WINDOWS directory first, and if the TWAIN DSM can be found in the WINDOWS directory, the search stops successfully (as it is not necessary to search SYSTEM and the OS for the DSM file).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>By default, if DTWAIN_SetDSMSearchOrder is never called by the application, the search order used by DTWAIN to locate and load the DSM is <span style="font-weight: bold;">DTWAIN_TWAINDSMSEARCH_WSO.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="text-decoration: underline;">Please note:</span></p>
<p><span style="color: #ff0000;">Previous versions of DTWAIN prior to Version 4.2,used the </span><span style="font-weight: bold; color: #ff0000;">DTWAIN_TWAINDSMSEARCH_O </span><span style="color: #ff0000;">search order</span><span style="font-weight: bold; color: #ff0000;">. &nbsp; </span><span style="color: #ff0000;">DTWAIN 4.2 and above now sets the default search option to </span><span style="font-weight: bold; color: #ff0000;">DTWAIN_TWAINDSMSEARCH_WSO.  </span><span style="color: #ff0000;">Therefore if you are using DTWAIN 4.2 or above, and want to use the same DSM search order as versions prior to 4.2, your application must call </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic; font-weight: bold; color: #ff0000;">DTWAIN_SetDSMSearchOrder( DTWAIN_TWAINDSMSEARCH_O )</span><span style="font-style: italic; color: #ff0000;"> </span></p>
<p><span style="color: #ff0000;">or</span></p>
<p><span style="font-style: italic; font-weight: bold; color: #ff0000;">DTWAIN_SetDSMSearchOrder( 8 )</span><span style="font-style: italic; color: #ff0000;"> </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #ff0000;">prior to any other DTWAIN function calls.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>None.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p>None.</p>

</td></tr></table>

</body>
</html>
