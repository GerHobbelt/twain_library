<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DTWAIN_SetFileAutoIncrement</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="dtwain32_popup_html.js"></script><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dtwain_setfileautoincrement.htm"; }
  else { parent.quicksync('a5.309'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">DTWAIN_SetFileAutoIncrement</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_seterrorbufferthreshold.htm">Previous</a>&nbsp;
     <a href="dtwain_setfilesavepos.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The <span style="font-weight: bold;">DTWAIN_SetFileAutoIncrement </span>allows image files to be named by incrementing a number field in the file name.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_BOOL &nbsp;DTWAIN_SetFileAutoIncrement ( </span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table cellspacing="0" cellpadding="0" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="139" style="width:139px;"><p><span style="font-weight: bold;">DTWAIN_SOURCE</span></p>
</td>
<td valign="top" width="121" style="width:121px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="139" style="width:139px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td valign="top" width="121" style="width:121px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Increment,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="139" style="width:139px;"><p><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td valign="top" width="121" style="width:121px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bResetAfterAcquire,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="139" style="width:139px;"><p><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td valign="top" width="121" style="width:121px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bEnable </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies an open <a href="twain_data_source.htm">TWAIN Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">Increment</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the amount to increment the number field.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">bResetAfterAcquire</span></p>
<p style="margin: 0px 0px 0px 15px;">Enables resetting increment start number after each acquisition.</p>
<p><span style="color: #000000;">&nbsp;</span><br>
<span style="font-style: italic;">bEnable</span></p>
<p style="margin: 0px 0px 0px 15px;">Enables or disables auto-increment mode.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>If the function succeeds, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, true);" class="popuplink">TRUE</a> is returned. &nbsp;If the function fails <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, true);" class="popuplink">FALSE</a> is returned.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>The DTWAIN_SetFileAutoIncrement controls the naming of image files when <a href="dtwain_acquirefile.htm">DTWAIN_AcquireFile</a> or <a href="dtwain_acquirefileex.htm">DTWAIN_AcquireFileEx</a> is used to acquire images. &nbsp;When the auto increment mode is used, file names will be named according to the base file name, the page acquired, and the increment count.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">Source </span>parameter is the DTWAIN_SOURCE that will use the auto-increment feature. &nbsp;The <span style="font-style: italic;">Increment</span> is the increment value used.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">bResetAfterAcquire</span> should be <span style="font-weight: bold;">TRUE</span> if the file naming will start from the base file name if more than one acquisition is attempted in a single session. &nbsp;For example, if your application shows the TWAIN Source's user interface during acquisition, and the user acquires all the pages, and without closing the user interface, places more paper into the feeder and acquires all the pages again, setting <span style="font-style: italic;">bResetAfterAcquire</span> to <span style="font-weight: bold;">FALSE </span>ensures that the file names will be unique. &nbsp;If <span style="font-style: italic;">bResetAfterAcquire</span> is <span style="font-weight: bold;">TRUE</span>, a new acquisition will always start naming the files from the base file name. &nbsp;The <span style="font-style: italic;">bResetAfterAcquire</span> should be set to <span style="font-weight: bold;">FALSE</span> to ensure that multiple acquisitions do not result in files being overwritten.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Note: If the user closes the Twain user interface, your application is responsible for saving the files acquired. &nbsp;DTWAIN_SetFileAutoIncrement does not "remember" the files that were saved if the user closes the Twain user interface.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">bEnable</span> parameter must be <span style="font-weight: bold;">TRUE</span> to turn on auto-increment mode, <span style="font-weight: bold;">FALSE</span> to turn off auto-increment mode. &nbsp;If <span style="font-style: italic;">bEnable</span> is FALSE, then the file naming convention reverts to the standard naming convention described in DTWAIN_AcquireFile.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The DTWAIN_SetFileAutoIncrement function should be called prior to calling DTWAIN_AcquireFile or DTWAIN_AcquireFileEx.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Example of auto-increment:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the name of the base file is FILE001.BMP, and 4 pages are acquired, and the increment is 1, the names of the files will be</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>FILE001.BMP</p>
<p>FILE002.BMP</p>
<p>FILE003.BMP</p>
<p>FILE004.BMP</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the increment is set to 2, and the base file name is FILE000.BMP, the names of the files generated will be</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>FILE000.BMP</p>
<p>FILE002.BMP</p>
<p>FILE004.BMP</p>
<p>FILE006.BMP</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the increment is set to -1, and the base file name is FILE999.BMP, the names of the files will be:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>FILE999.BMP</p>
<p>FILE998.BMP</p>
<p>FILE997.BMP</p>
<p>FILE996.BMP</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The base file name is the file name specified in the call to DTWAIN_AcquireFile or DTWAIN_AcquireFileEx. &nbsp;Since these functions have the ability to accept multiple file names, if the auto-increment is on, only the first name in the list of names is considered.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The file name should consist of a numeric suffix. &nbsp;The number of digits in the suffix determines the maximum number of pages that can be acquired without overwriting the files that have already been generated. &nbsp;For example, a base file name of FILE0000.BMP will be able to acquire up to 10,000 pages in a single acquisition without overwriting previous files, since numbers 0000 to 9999 can be generated. &nbsp;If the number of pages exceeds the number of unique file names that can be generated with the numeric suffix, DTWAIN does not check for file overwrites. &nbsp;Therefore, you must make sure that the numeric suffix used in the file name is large enough to hold all of the pages that are planned to be acquired.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the file name does not contain a numeric suffix, the naming convention in auto-increment mode is to append a number to the end of the file name. &nbsp;The number always starts at 0 up to the total number of pages acquired. &nbsp;For example, if the base name is FILEABC.BMP, and 4 pages are acquired, the following will be the names of the files:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>FILEABC0.BMP</p>
<p>FILEABC1.BMP</p>
<p>FILEABC2.BMP</p>
<p>FILEABC3.BMP</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Using the non-numeric suffix ensures that you will get unique file names, regardless of the number of pages, however you cannot control the increment step or the starting number in the file name.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To turn off the auto-increment mode, call DTWAIN_SetFileAutoIncrement with the <span style="font-style: italic;">bEnable</span> parameter set to FALSE.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; text-decoration: underline;">Examples:</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_SetFileAutoIncrement( Source, &nbsp;1, TRUE, TRUE );</span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_AcquireFile( Source, "FILE000.BMP", DTWAIN_BMP, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_USENATIVE + DTWAIN_USEPROMPT, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PT_DEFAULT, DTWAIN_ACQUIREALL, TRUE, TRUE, NULL);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The above example will generate files named FILE000.BMP, FILE001.BMP, FILE002.BMP, etc. for pages being acquired. &nbsp;A maximum of 1,000 pages with unique file names can be acquired since "FILE000.BMP" can generate names from FILE000.BMP to FILE999.BMP.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_SetFileAutoIncrement( Source, &nbsp;2, &nbsp;FALSE, TRUE );</span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;">DTWAIN_AcquireFile( Source, "FILE0005.BMP", DTWAIN_BMP, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_USENATIVE + DTWAIN_USEPROMPT, </span></p>
<p><span style="font-size: 8pt; font-family: 'Times New Roman'; font-weight: bold; color: #010100;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_PT_DEFAULT, DTWAIN_ACQUIREALL, TRUE, TRUE, NULL);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The above example will generate files named FILE005.BMP, FILE007.BMP, FILE009.BMP, FILE011.BMP, etc.in a single acquisition. &nbsp;If the user decides to start another acquisition without closing the Twain user interface, the file names will continue from the last name generated (this is because of the <span style="font-style: italic;">bResetOnAcquire</span> flag being set to FALSE in the call to DTWAIN_SetFileAutoIncrement).</p>
<p><span style="width:48px">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>None</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Calls</span></p>
<p><a href="dtwain_sysinitialize.htm">DTWAIN_SysInitialize</a></p>
<p><a href="dtwain_source_functions.htm">Source Selection Functions</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>&nbsp;</p>

</td></tr></table>

</body>
</html>
